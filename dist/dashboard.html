<!doctype html>
<html lang="en-US">

<head>
    <meta charset="utf-8" />
    <title>UK Accidents Dashboard</title>
  <script type="module" crossorigin>var Ro=Object.defineProperty;var Po=(t,n,e)=>n in t?Ro(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e;var C=(t,n,e)=>Po(t,typeof n!="symbol"?n+"":n,e);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=e(i);fetch(i.href,a)}})();var Qt=(t=>(t[t.AUTHORISED_PERSON=0]="AUTHORISED_PERSON",t[t.AUTOMATIC_TRAFFIC_SIGNAL=1]="AUTOMATIC_TRAFFIC_SIGNAL",t[t.GIVEWAY_OR_UNCONTROLLED=2]="GIVEWAY_OR_UNCONTROLLED",t[t.STOP_SIGN=3]="STOP_SIGN",t[t.UNKNOWN=4]="UNKNOWN",t))(Qt||{}),Tt=(t=>(t[t.DUAL_CARRIAGEWAY=0]="DUAL_CARRIAGEWAY",t[t.ONE_WAY_STREET=1]="ONE_WAY_STREET",t[t.ROUNDABOUT=2]="ROUNDABOUT",t[t.SINGLE_CARRIAGEWAY=3]="SINGLE_CARRIAGEWAY",t[t.SLIP_ROAD=4]="SLIP_ROAD",t[t.UNKNOWN=5]="UNKNOWN",t))(Tt||{}),Ti=(t=>(t[t.HIGH=3]="HIGH",t[t.MID=2]="MID",t[t.LOW=1]="LOW",t))(Ti||{}),ke=(t=>(t[t["10KMH"]=10]="10KMH",t[t["15KMH"]=15]="15KMH",t[t["20KMH"]=20]="20KMH",t[t["30KMH"]=30]="30KMH",t[t["40KMH"]=40]="40KMH",t[t["50KMH"]=50]="50KMH",t[t["60KMH"]=60]="60KMH",t[t["70KMH"]=70]="70KMH",t[t.UNKNOWN=-1]="UNKNOWN",t))(ke||{}),St=(t=>(t[t.Dry=0]="Dry",t[t["Flood (Over 3cm of water)"]=1]="Flood (Over 3cm of water)",t[t["Frost/Ice"]=2]="Frost/Ice",t[t.Snow=3]="Snow",t[t["Wet/Damp"]=4]="Wet/Damp",t[t.UNKNOWN=-1]="UNKNOWN",t))(St||{}),ft=(t=>(t[t["Fine with high winds"]=0]="Fine with high winds",t[t["Fine without high winds"]=1]="Fine without high winds",t[t["Fog or mist"]=2]="Fog or mist",t[t.Other=3]="Other",t[t["Raining with high winds"]=4]="Raining with high winds",t[t["Raining without high winds"]=5]="Raining without high winds",t[t["Snowing with high winds"]=6]="Snowing with high winds",t[t["Snowing without high winds"]=7]="Snowing without high winds",t[t.UNKNOWN=-1]="UNKNOWN",t))(ft||{}),Ft=(t=>(t[t["Darkeness: No street lighting"]=0]="Darkeness: No street lighting",t[t["Darkness: Street lighting unknown"]=1]="Darkness: Street lighting unknown",t[t["Darkness: Street lights present and lit"]=2]="Darkness: Street lights present and lit",t[t["Darkness: Street lights present but unlit"]=3]="Darkness: Street lights present but unlit",t[t["Daylight: Street light present"]=4]="Daylight: Street light present",t[t.UNKNOWN=-1]="UNKNOWN",t))(Ft||{}),Ut=(t=>(t[t["Central refuge"]=0]="Central refuge",t[t["Footbridge or subway"]=1]="Footbridge or subway",t[t["No physical crossing within 50 meters"]=2]="No physical crossing within 50 meters",t[t["Pedestrian phase at traffic signal junction"]=3]="Pedestrian phase at traffic signal junction",t[t["Zebra crossing"]=4]="Zebra crossing",t[t["non-junction pedestrian crossing"]=5]="non-junction pedestrian crossing",t[t.UNKNOWN=-1]="UNKNOWN",t))(Ut||{}),bt=(t=>(t[t["Auto traffic signal partly defective"]=0]="Auto traffic signal partly defective",t[t["Auto traffic singal out"]=1]="Auto traffic singal out",t[t.Mud=2]="Mud",t[t["Ol or diesel"]=3]="Ol or diesel",t[t["Permanent sign or marking defective or obscured"]=4]="Permanent sign or marking defective or obscured",t[t["Road surface defective"]=5]="Road surface defective",t[t.Roadworks=6]="Roadworks",t[t.UNKNOWN=-1]="UNKNOWN",t))(bt||{}),Rt=(t=>(t[t["Any animal (except a ridden horse)"]=0]="Any animal (except a ridden horse)",t[t["Dislodged vehicle load in carriageway"]=1]="Dislodged vehicle load in carriageway",t[t["Involvement with previous accident"]=2]="Involvement with previous accident",t[t["Other object in carriageway"]=3]="Other object in carriageway",t[t["Pedestrian in carriageway (not injured)"]=4]="Pedestrian in carriageway (not injured)",t[t.UNKNOWN=-1]="UNKNOWN",t))(Rt||{});async function Yo(t){const n=new Array,r=(await t.text()).split(`
`);let i=0;for(let a=0;a<r.length;++a){if(a==0)continue;const o=r[a].split(","),u=Number(o[6]),f=u!=1&&u!=2&&u!=3?void 0:u;if(f==null)throw new Error(`accident severity takes a value other than: 1 | 2 | 3: ${u}`);const s=o[16].toLowerCase(),c=s=="dual carriageway"?Tt.DUAL_CARRIAGEWAY:s=="one way street"?Tt.ONE_WAY_STREET:s=="roundabout"?Tt.ROUNDABOUT:s=="single carriageway"?Tt.SINGLE_CARRIAGEWAY:s=="slip road"?Tt.SLIP_ROAD:Tt.UNKNOWN,l=o[19].toLowerCase(),h=l=="authorised person"?Qt.AUTHORISED_PERSON:l=="automatic traffic signal"?Qt.AUTOMATIC_TRAFFIC_SIGNAL:l=="giveway or uncontrolled"?Qt.GIVEWAY_OR_UNCONTROLLED:l=="stop sign"?Qt.STOP_SIGN:Qt.UNKNOWN,g=o[9].split("/"),p=new Date(`${g[2]}-${g[1]}-${g[0]}T${o[11].replace("/",":")}`);if(Number.isNaN(p.valueOf())){++i;continue}const x=o[23]=="Central refuge"?Ut["Central refuge"]:o[23]=="Footbridge or subway"?Ut["Footbridge or subway"]:o[23]=="No physical crossing within 50 meters"?Ut["No physical crossing within 50 meters"]:o[23]=="Pedestrian phase at traffic signal junction"?Ut["Pedestrian phase at traffic signal junction"]:o[23]=="Zebra crossing"?Ut["Zebra crossing"]:o[23]=="non-junction pedestrian crossing"?Ut["non-junction pedestrian crossing"]:Ut.UNKNOWN,_=o[24]=="Darkeness: No street lighting"?Ft["Darkeness: No street lighting"]:o[24]=="Darkness: Street lighting unknown"?Ft["Darkness: Street lighting unknown"]:o[24]=="Darkness: Street lights present and lit"?Ft["Darkness: Street lights present and lit"]:o[24]=="Darkness: Street lights present but unlit"?Ft["Darkness: Street lights present but unlit"]:o[24]=="Daylight: Street light present"?Ft["Daylight: Street light present"]:Ft.UNKNOWN,v=o[25]=="Fine with high winds"?ft["Fine with high winds"]:o[25]=="Fine without high winds"?ft["Fine without high winds"]:o[25]=="Fog or mist"?ft["Fog or mist"]:o[25]=="Other"?ft.Other:o[25]=="Raining with high winds"?ft["Raining with high winds"]:o[25]=="Raining without high winds"?ft["Raining without high winds"]:o[25]=="Snowing with high winds"?ft["Snowing with high winds"]:o[25]=="Snowing without high winds"?ft["Snowing without high winds"]:ft.UNKNOWN,b=o[26]=="Dry"?St.Dry:o[26]=="Flood (Over 3cm of water)"?St["Flood (Over 3cm of water)"]:o[26]=="Frost/Ice"?St["Frost/Ice"]:o[26]=="Snow"?St.Snow:o[26]=="Wet/Damp"?St["Wet/Damp"]:St.UNKNOWN,M=o[27]=="Auto traffic signal partly defective"?bt["Auto traffic signal partly defective"]:o[27]=="Auto traffic singal out"?bt["Auto traffic singal out"]:o[27]=="Mud"?bt.Mud:o[27]=="Ol or diesel"?bt["Ol or diesel"]:o[27]=="Permanent sign or marking defective or obscured"?bt["Permanent sign or marking defective or obscured"]:o[27]=="Road surface defective"?bt["Road surface defective"]:o[27]=="Roadworks"?bt.Roadworks:bt.UNKNOWN,N=o[28]=="Any animal (except a ridden horse)"?Rt["Any animal (except a ridden horse)"]:o[28]=="Dislodged vehicle load in carriageway"?Rt["Dislodged vehicle load in carriageway"]:o[28]=="Involvement with previous accident"?Rt["Involvement with previous accident"]:o[28]=="Other object in carriageway"?Rt["Other object in carriageway"]:o[28]=="Pedestrian in carriageway (not injured)"?Rt["Pedestrian in carriageway (not injured)"]:Rt.UNKNOWN;n.push({longitude:Number(o[3]),latitude:Number(o[4]),accidentSeverity:f,nbrOfVehicles:Number(o[7]),nbrOfCasualties:Number(o[8]),date:p,roadType:c,speedLimit:parseInt(o[17],10),juncitionControl:h,pedestrianCrossingPhysicalFacilities:x,lightConditions:_,weatherConditions:v,roadSurfaceConditions:b,specialConditionsAtSite:M,carriagewayHazards:N})}return i&&console.log(`ignored ${i} entries because of invalid Dates`),n}var Ae="http://www.w3.org/1999/xhtml";const br={svg:"http://www.w3.org/2000/svg",xhtml:Ae,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function le(t){var n=t+="",e=n.indexOf(":");return e>=0&&(n=t.slice(0,e))!=="xmlns"&&(t=t.slice(e+1)),br.hasOwnProperty(n)?{space:br[n],local:t}:t}function Lo(t){return function(){var n=this.ownerDocument,e=this.namespaceURI;return e===Ae&&n.documentElement.namespaceURI===Ae?n.createElement(t):n.createElementNS(e,t)}}function Ho(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Je(t){var n=le(t);return(n.local?Ho:Lo)(n)}function Wo(){}function je(t){return t==null?Wo:function(){return this.querySelector(t)}}function qo(t){typeof t!="function"&&(t=je(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var a=n[i],o=a.length,u=r[i]=new Array(o),f,s,c=0;c<o;++c)(f=a[c])&&(s=t.call(f,f.__data__,c,a))&&("__data__"in f&&(s.__data__=f.__data__),u[c]=s);return new ct(r,this._parents)}function Bo(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Ko(){return[]}function Si(t){return t==null?Ko:function(){return this.querySelectorAll(t)}}function Go(t){return function(){return Bo(t.apply(this,arguments))}}function Vo(t){typeof t=="function"?t=Go(t):t=Si(t);for(var n=this._groups,e=n.length,r=[],i=[],a=0;a<e;++a)for(var o=n[a],u=o.length,f,s=0;s<u;++s)(f=o[s])&&(r.push(t.call(f,f.__data__,s,o)),i.push(f));return new ct(r,i)}function Di(t){return function(){return this.matches(t)}}function Ei(t){return function(n){return n.matches(t)}}var Xo=Array.prototype.find;function Zo(t){return function(){return Xo.call(this.children,t)}}function Qo(){return this.firstElementChild}function Jo(t){return this.select(t==null?Qo:Zo(typeof t=="function"?t:Ei(t)))}var jo=Array.prototype.filter;function ta(){return Array.from(this.children)}function na(t){return function(){return jo.call(this.children,t)}}function ea(t){return this.selectAll(t==null?ta:na(typeof t=="function"?t:Ei(t)))}function ra(t){typeof t!="function"&&(t=Di(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var a=n[i],o=a.length,u=r[i]=[],f,s=0;s<o;++s)(f=a[s])&&t.call(f,f.__data__,s,a)&&u.push(f);return new ct(r,this._parents)}function ki(t){return new Array(t.length)}function ia(){return new ct(this._enter||this._groups.map(ki),this._parents)}function Kn(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}Kn.prototype={constructor:Kn,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function oa(t){return function(){return t}}function aa(t,n,e,r,i,a){for(var o=0,u,f=n.length,s=a.length;o<s;++o)(u=n[o])?(u.__data__=a[o],r[o]=u):e[o]=new Kn(t,a[o]);for(;o<f;++o)(u=n[o])&&(i[o]=u)}function ua(t,n,e,r,i,a,o){var u,f,s=new Map,c=n.length,l=a.length,h=new Array(c),g;for(u=0;u<c;++u)(f=n[u])&&(h[u]=g=o.call(f,f.__data__,u,n)+"",s.has(g)?i[u]=f:s.set(g,f));for(u=0;u<l;++u)g=o.call(t,a[u],u,a)+"",(f=s.get(g))?(r[u]=f,f.__data__=a[u],s.delete(g)):e[u]=new Kn(t,a[u]);for(u=0;u<c;++u)(f=n[u])&&s.get(h[u])===f&&(i[u]=f)}function sa(t){return t.__data__}function la(t,n){if(!arguments.length)return Array.from(this,sa);var e=n?ua:aa,r=this._parents,i=this._groups;typeof t!="function"&&(t=oa(t));for(var a=i.length,o=new Array(a),u=new Array(a),f=new Array(a),s=0;s<a;++s){var c=r[s],l=i[s],h=l.length,g=ca(t.call(c,c&&c.__data__,s,r)),p=g.length,x=u[s]=new Array(p),_=o[s]=new Array(p),v=f[s]=new Array(h);e(c,l,x,_,v,g,n);for(var b=0,M=0,N,D;b<p;++b)if(N=x[b]){for(b>=M&&(M=b+1);!(D=_[M])&&++M<p;);N._next=D||null}}return o=new ct(o,r),o._enter=u,o._exit=f,o}function ca(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function fa(){return new ct(this._exit||this._groups.map(ki),this._parents)}function ha(t,n,e){var r=this.enter(),i=this,a=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),n!=null&&(i=n(i),i&&(i=i.selection())),e==null?a.remove():e(a),r&&i?r.merge(i).order():i}function ga(t){for(var n=t.selection?t.selection():t,e=this._groups,r=n._groups,i=e.length,a=r.length,o=Math.min(i,a),u=new Array(i),f=0;f<o;++f)for(var s=e[f],c=r[f],l=s.length,h=u[f]=new Array(l),g,p=0;p<l;++p)(g=s[p]||c[p])&&(h[p]=g);for(;f<i;++f)u[f]=e[f];return new ct(u,this._parents)}function pa(){for(var t=this._groups,n=-1,e=t.length;++n<e;)for(var r=t[n],i=r.length-1,a=r[i],o;--i>=0;)(o=r[i])&&(a&&o.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(o,a),a=o);return this}function da(t){t||(t=ma);function n(l,h){return l&&h?t(l.__data__,h.__data__):!l-!h}for(var e=this._groups,r=e.length,i=new Array(r),a=0;a<r;++a){for(var o=e[a],u=o.length,f=i[a]=new Array(u),s,c=0;c<u;++c)(s=o[c])&&(f[c]=s);f.sort(n)}return new ct(i,this._parents).order()}function ma(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function ya(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function va(){return Array.from(this)}function wa(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r=t[n],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null}function _a(){let t=0;for(const n of this)++t;return t}function xa(){return!this.node()}function Ma(t){for(var n=this._groups,e=0,r=n.length;e<r;++e)for(var i=n[e],a=0,o=i.length,u;a<o;++a)(u=i[a])&&t.call(u,u.__data__,a,i);return this}function Na(t){return function(){this.removeAttribute(t)}}function ba(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ta(t,n){return function(){this.setAttribute(t,n)}}function Sa(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}function Da(t,n){return function(){var e=n.apply(this,arguments);e==null?this.removeAttribute(t):this.setAttribute(t,e)}}function Ea(t,n){return function(){var e=n.apply(this,arguments);e==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}}function ka(t,n){var e=le(t);if(arguments.length<2){var r=this.node();return e.local?r.getAttributeNS(e.space,e.local):r.getAttribute(e)}return this.each((n==null?e.local?ba:Na:typeof n=="function"?e.local?Ea:Da:e.local?Sa:Ta)(e,n))}function Ai(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Aa(t){return function(){this.style.removeProperty(t)}}function $a(t,n,e){return function(){this.style.setProperty(t,n,e)}}function Ia(t,n,e){return function(){var r=n.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,e)}}function Ua(t,n,e){return arguments.length>1?this.each((n==null?Aa:typeof n=="function"?Ia:$a)(t,n,e??"")):nn(this.node(),t)}function nn(t,n){return t.style.getPropertyValue(n)||Ai(t).getComputedStyle(t,null).getPropertyValue(n)}function Ca(t){return function(){delete this[t]}}function Oa(t,n){return function(){this[t]=n}}function za(t,n){return function(){var e=n.apply(this,arguments);e==null?delete this[t]:this[t]=e}}function Fa(t,n){return arguments.length>1?this.each((n==null?Ca:typeof n=="function"?za:Oa)(t,n)):this.node()[t]}function $i(t){return t.trim().split(/^|\s+/)}function tr(t){return t.classList||new Ii(t)}function Ii(t){this._node=t,this._names=$i(t.getAttribute("class")||"")}Ii.prototype={add:function(t){var n=this._names.indexOf(t);n<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var n=this._names.indexOf(t);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Ui(t,n){for(var e=tr(t),r=-1,i=n.length;++r<i;)e.add(n[r])}function Ci(t,n){for(var e=tr(t),r=-1,i=n.length;++r<i;)e.remove(n[r])}function Ra(t){return function(){Ui(this,t)}}function Pa(t){return function(){Ci(this,t)}}function Ya(t,n){return function(){(n.apply(this,arguments)?Ui:Ci)(this,t)}}function La(t,n){var e=$i(t+"");if(arguments.length<2){for(var r=tr(this.node()),i=-1,a=e.length;++i<a;)if(!r.contains(e[i]))return!1;return!0}return this.each((typeof n=="function"?Ya:n?Ra:Pa)(e,n))}function Ha(){this.textContent=""}function Wa(t){return function(){this.textContent=t}}function qa(t){return function(){var n=t.apply(this,arguments);this.textContent=n??""}}function Ba(t){return arguments.length?this.each(t==null?Ha:(typeof t=="function"?qa:Wa)(t)):this.node().textContent}function Ka(){this.innerHTML=""}function Ga(t){return function(){this.innerHTML=t}}function Va(t){return function(){var n=t.apply(this,arguments);this.innerHTML=n??""}}function Xa(t){return arguments.length?this.each(t==null?Ka:(typeof t=="function"?Va:Ga)(t)):this.node().innerHTML}function Za(){this.nextSibling&&this.parentNode.appendChild(this)}function Qa(){return this.each(Za)}function Ja(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ja(){return this.each(Ja)}function tu(t){var n=typeof t=="function"?t:Je(t);return this.select(function(){return this.appendChild(n.apply(this,arguments))})}function nu(){return null}function eu(t,n){var e=typeof t=="function"?t:Je(t),r=n==null?nu:typeof n=="function"?n:je(n);return this.select(function(){return this.insertBefore(e.apply(this,arguments),r.apply(this,arguments)||null)})}function ru(){var t=this.parentNode;t&&t.removeChild(this)}function iu(){return this.each(ru)}function ou(){var t=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function au(){var t=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function uu(t){return this.select(t?au:ou)}function su(t){return arguments.length?this.property("__data__",t):this.node().__data__}function lu(t){return function(n){t.call(this,n,this.__data__)}}function cu(t){return t.trim().split(/^|\s+/).map(function(n){var e="",r=n.indexOf(".");return r>=0&&(e=n.slice(r+1),n=n.slice(0,r)),{type:n,name:e}})}function fu(t){return function(){var n=this.__on;if(n){for(var e=0,r=-1,i=n.length,a;e<i;++e)a=n[e],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.options):n[++r]=a;++r?n.length=r:delete this.__on}}}function hu(t,n,e){return function(){var r=this.__on,i,a=lu(n);if(r){for(var o=0,u=r.length;o<u;++o)if((i=r[o]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=e),i.value=n;return}}this.addEventListener(t.type,a,e),i={type:t.type,name:t.name,value:n,listener:a,options:e},r?r.push(i):this.__on=[i]}}function gu(t,n,e){var r=cu(t+""),i,a=r.length,o;if(arguments.length<2){var u=this.node().__on;if(u){for(var f=0,s=u.length,c;f<s;++f)for(i=0,c=u[f];i<a;++i)if((o=r[i]).type===c.type&&o.name===c.name)return c.value}return}for(u=n?hu:fu,i=0;i<a;++i)this.each(u(r[i],n,e));return this}function Oi(t,n,e){var r=Ai(t),i=r.CustomEvent;typeof i=="function"?i=new i(n,e):(i=r.document.createEvent("Event"),e?(i.initEvent(n,e.bubbles,e.cancelable),i.detail=e.detail):i.initEvent(n,!1,!1)),t.dispatchEvent(i)}function pu(t,n){return function(){return Oi(this,t,n)}}function du(t,n){return function(){return Oi(this,t,n.apply(this,arguments))}}function mu(t,n){return this.each((typeof n=="function"?du:pu)(t,n))}function*yu(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r=t[n],i=0,a=r.length,o;i<a;++i)(o=r[i])&&(yield o)}var zi=[null];function ct(t,n){this._groups=t,this._parents=n}function Sn(){return new ct([[document.documentElement]],zi)}function vu(){return this}ct.prototype=Sn.prototype={constructor:ct,select:qo,selectAll:Vo,selectChild:Jo,selectChildren:ea,filter:ra,data:la,enter:ia,exit:fa,join:ha,merge:ga,selection:vu,order:pa,sort:da,call:ya,nodes:va,node:wa,size:_a,empty:xa,each:Ma,attr:ka,style:Ua,property:Fa,classed:La,text:Ba,html:Xa,raise:Qa,lower:ja,append:tu,insert:eu,remove:iu,clone:uu,datum:su,on:gu,dispatch:mu,[Symbol.iterator]:yu};function Dt(t){return typeof t=="string"?new ct([[document.querySelector(t)]],[document.documentElement]):new ct([[t]],zi)}function ce(t){return Dt(Je(t).call(document.documentElement))}function wu(t){let n;for(;n=t.sourceEvent;)t=n;return t}function zt(t,n){if(t=wu(t),n===void 0&&(n=t.currentTarget),n){var e=n.ownerSVGElement||n;if(e.createSVGPoint){var r=e.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(n.getScreenCTM().inverse()),[r.x,r.y]}if(n.getBoundingClientRect){var i=n.getBoundingClientRect();return[t.clientX-i.left-n.clientLeft,t.clientY-i.top-n.clientTop]}}return[t.pageX,t.pageY]}function _u(t){return t.k}function xu(t){return[t.x,t.y]}function Tr(t){return function(){return t}}function Mu(){let t=0,n=0,e=960,r=500,i=!0,a=!0,o=256,u=_u,f=xu,s=0;function c(){const l=+u.apply(this,arguments),h=f.apply(this,arguments),g=Math.log2(l/o),p=Math.round(Math.max(g+s,0)),x=Math.pow(2,g-p)*o,_=+h[0]-l/2,v=+h[1]-l/2,b=Math.max(i?0:-1/0,Math.floor((t-_)/x)),M=Math.min(i?1<<p:1/0,Math.ceil((e-_)/x)),N=Math.max(a?0:-1/0,Math.floor((n-v)/x)),D=Math.min(a?1<<p:1/0,Math.ceil((r-v)/x)),w=[];for(let k=N;k<D;++k)for(let U=b;U<M;++U)w.push([U,k,p]);return w.translate=[_/x,v/x],w.scale=x,w}return c.size=function(l){return arguments.length?(t=n=0,e=+l[0],r=+l[1],c):[e-t,r-n]},c.extent=function(l){return arguments.length?(t=+l[0][0],n=+l[0][1],e=+l[1][0],r=+l[1][1],c):[[t,n],[e,r]]},c.scale=function(l){return arguments.length?(u=typeof l=="function"?l:Tr(+l),c):u},c.translate=function(l){return arguments.length?(f=typeof l=="function"?l:Tr([+l[0],+l[1]]),c):f},c.zoomDelta=function(l){return arguments.length?(s=+l,c):s},c.tileSize=function(l){return arguments.length?(o=+l,c):o},c.clamp=function(l){return arguments.length?(i=a=!!l,c):i&&a},c.clampX=function(l){return arguments.length?(i=!!l,c):i},c.clampY=function(l){return arguments.length?(a=!!l,c):a},c}function Nu([t,n,e]){const r=1<<e;return[t-Math.floor(t/r)*r,n-Math.floor(n/r)*r,e]}var bu={value:()=>{}};function nr(){for(var t=0,n=arguments.length,e={},r;t<n;++t){if(!(r=arguments[t]+"")||r in e||/[\s.]/.test(r))throw new Error("illegal type: "+r);e[r]=[]}return new Pn(e)}function Pn(t){this._=t}function Tu(t,n){return t.trim().split(/^|\s+/).map(function(e){var r="",i=e.indexOf(".");if(i>=0&&(r=e.slice(i+1),e=e.slice(0,i)),e&&!n.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:r}})}Pn.prototype=nr.prototype={constructor:Pn,on:function(t,n){var e=this._,r=Tu(t+"",e),i,a=-1,o=r.length;if(arguments.length<2){for(;++a<o;)if((i=(t=r[a]).type)&&(i=Su(e[i],t.name)))return i;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++a<o;)if(i=(t=r[a]).type)e[i]=Sr(e[i],t.name,n);else if(n==null)for(i in e)e[i]=Sr(e[i],t.name,null);return this},copy:function(){var t={},n=this._;for(var e in n)t[e]=n[e].slice();return new Pn(t)},call:function(t,n){if((i=arguments.length-2)>0)for(var e=new Array(i),r=0,i,a;r<i;++r)e[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],r=0,i=a.length;r<i;++r)a[r].value.apply(n,e)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(n,e)}};function Su(t,n){for(var e=0,r=t.length,i;e<r;++e)if((i=t[e]).name===n)return i.value}function Sr(t,n,e){for(var r=0,i=t.length;r<i;++r)if(t[r].name===n){t[r]=bu,t=t.slice(0,r).concat(t.slice(r+1));break}return e!=null&&t.push({name:n,value:e}),t}const $e={capture:!0,passive:!1};function Ie(t){t.preventDefault(),t.stopImmediatePropagation()}function Du(t){var n=t.document.documentElement,e=Dt(t).on("dragstart.drag",Ie,$e);"onselectstart"in n?e.on("selectstart.drag",Ie,$e):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function Eu(t,n){var e=t.document.documentElement,r=Dt(t).on("dragstart.drag",null);n&&(r.on("click.drag",Ie,$e),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in e?r.on("selectstart.drag",null):(e.style.MozUserSelect=e.__noselect,delete e.__noselect)}function er(t,n,e){t.prototype=n.prototype=e,e.constructor=t}function Fi(t,n){var e=Object.create(t.prototype);for(var r in n)e[r]=n[r];return e}function Dn(){}var wn=.7,Gn=1/wn,tn="\\s*([+-]?\\d+)\\s*",_n="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",xt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ku=/^#([0-9a-f]{3,8})$/,Au=new RegExp(`^rgb\\(${tn},${tn},${tn}\\)$`),$u=new RegExp(`^rgb\\(${xt},${xt},${xt}\\)$`),Iu=new RegExp(`^rgba\\(${tn},${tn},${tn},${_n}\\)$`),Uu=new RegExp(`^rgba\\(${xt},${xt},${xt},${_n}\\)$`),Cu=new RegExp(`^hsl\\(${_n},${xt},${xt}\\)$`),Ou=new RegExp(`^hsla\\(${_n},${xt},${xt},${_n}\\)$`),Dr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};er(Dn,qt,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Er,formatHex:Er,formatHex8:zu,formatHsl:Fu,formatRgb:kr,toString:kr});function Er(){return this.rgb().formatHex()}function zu(){return this.rgb().formatHex8()}function Fu(){return Ri(this).formatHsl()}function kr(){return this.rgb().formatRgb()}function qt(t){var n,e;return t=(t+"").trim().toLowerCase(),(n=ku.exec(t))?(e=n[1].length,n=parseInt(n[1],16),e===6?Ar(n):e===3?new it(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):e===8?kn(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):e===4?kn(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=Au.exec(t))?new it(n[1],n[2],n[3],1):(n=$u.exec(t))?new it(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=Iu.exec(t))?kn(n[1],n[2],n[3],n[4]):(n=Uu.exec(t))?kn(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=Cu.exec(t))?Ur(n[1],n[2]/100,n[3]/100,1):(n=Ou.exec(t))?Ur(n[1],n[2]/100,n[3]/100,n[4]):Dr.hasOwnProperty(t)?Ar(Dr[t]):t==="transparent"?new it(NaN,NaN,NaN,0):null}function Ar(t){return new it(t>>16&255,t>>8&255,t&255,1)}function kn(t,n,e,r){return r<=0&&(t=n=e=NaN),new it(t,n,e,r)}function Ru(t){return t instanceof Dn||(t=qt(t)),t?(t=t.rgb(),new it(t.r,t.g,t.b,t.opacity)):new it}function Vn(t,n,e,r){return arguments.length===1?Ru(t):new it(t,n,e,r??1)}function it(t,n,e,r){this.r=+t,this.g=+n,this.b=+e,this.opacity=+r}er(it,Vn,Fi(Dn,{brighter(t){return t=t==null?Gn:Math.pow(Gn,t),new it(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?wn:Math.pow(wn,t),new it(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new it(Lt(this.r),Lt(this.g),Lt(this.b),Xn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:$r,formatHex:$r,formatHex8:Pu,formatRgb:Ir,toString:Ir}));function $r(){return`#${Yt(this.r)}${Yt(this.g)}${Yt(this.b)}`}function Pu(){return`#${Yt(this.r)}${Yt(this.g)}${Yt(this.b)}${Yt((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ir(){const t=Xn(this.opacity);return`${t===1?"rgb(":"rgba("}${Lt(this.r)}, ${Lt(this.g)}, ${Lt(this.b)}${t===1?")":`, ${t})`}`}function Xn(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Lt(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Yt(t){return t=Lt(t),(t<16?"0":"")+t.toString(16)}function Ur(t,n,e,r){return r<=0?t=n=e=NaN:e<=0||e>=1?t=n=NaN:n<=0&&(t=NaN),new wt(t,n,e,r)}function Ri(t){if(t instanceof wt)return new wt(t.h,t.s,t.l,t.opacity);if(t instanceof Dn||(t=qt(t)),!t)return new wt;if(t instanceof wt)return t;t=t.rgb();var n=t.r/255,e=t.g/255,r=t.b/255,i=Math.min(n,e,r),a=Math.max(n,e,r),o=NaN,u=a-i,f=(a+i)/2;return u?(n===a?o=(e-r)/u+(e<r)*6:e===a?o=(r-n)/u+2:o=(n-e)/u+4,u/=f<.5?a+i:2-a-i,o*=60):u=f>0&&f<1?0:o,new wt(o,u,f,t.opacity)}function Yu(t,n,e,r){return arguments.length===1?Ri(t):new wt(t,n,e,r??1)}function wt(t,n,e,r){this.h=+t,this.s=+n,this.l=+e,this.opacity=+r}er(wt,Yu,Fi(Dn,{brighter(t){return t=t==null?Gn:Math.pow(Gn,t),new wt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?wn:Math.pow(wn,t),new wt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,r=e+(e<.5?e:1-e)*n,i=2*e-r;return new it(ve(t>=240?t-240:t+120,i,r),ve(t,i,r),ve(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new wt(Cr(this.h),An(this.s),An(this.l),Xn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Xn(this.opacity);return`${t===1?"hsl(":"hsla("}${Cr(this.h)}, ${An(this.s)*100}%, ${An(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Cr(t){return t=(t||0)%360,t<0?t+360:t}function An(t){return Math.max(0,Math.min(1,t||0))}function ve(t,n,e){return(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)*255}function Lu(t,n,e,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*n+(4-6*a+3*o)*e+(1+3*t+3*a-3*o)*r+o*i)/6}function Hu(t){var n=t.length-1;return function(e){var r=e<=0?e=0:e>=1?(e=1,n-1):Math.floor(e*n),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,u=r<n-1?t[r+2]:2*a-i;return Lu((e-r/n)*n,o,i,a,u)}}const rr=t=>()=>t;function Wu(t,n){return function(e){return t+e*n}}function qu(t,n,e){return t=Math.pow(t,e),n=Math.pow(n,e)-t,e=1/e,function(r){return Math.pow(t+r*n,e)}}function Bu(t){return(t=+t)==1?Pi:function(n,e){return e-n?qu(n,e,t):rr(isNaN(n)?e:n)}}function Pi(t,n){var e=n-t;return e?Wu(t,e):rr(isNaN(t)?n:t)}const Zn=function t(n){var e=Bu(n);function r(i,a){var o=e((i=Vn(i)).r,(a=Vn(a)).r),u=e(i.g,a.g),f=e(i.b,a.b),s=Pi(i.opacity,a.opacity);return function(c){return i.r=o(c),i.g=u(c),i.b=f(c),i.opacity=s(c),i+""}}return r.gamma=t,r}(1);function Ku(t){return function(n){var e=n.length,r=new Array(e),i=new Array(e),a=new Array(e),o,u;for(o=0;o<e;++o)u=Vn(n[o]),r[o]=u.r||0,i[o]=u.g||0,a[o]=u.b||0;return r=t(r),i=t(i),a=t(a),u.opacity=1,function(f){return u.r=r(f),u.g=i(f),u.b=a(f),u+""}}}var Gu=Ku(Hu);function Vu(t,n){n||(n=[]);var e=t?Math.min(n.length,t.length):0,r=n.slice(),i;return function(a){for(i=0;i<e;++i)r[i]=t[i]*(1-a)+n[i]*a;return r}}function Xu(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Zu(t,n){var e=n?n.length:0,r=t?Math.min(e,t.length):0,i=new Array(r),a=new Array(e),o;for(o=0;o<r;++o)i[o]=fe(t[o],n[o]);for(;o<e;++o)a[o]=n[o];return function(u){for(o=0;o<r;++o)a[o]=i[o](u);return a}}function Qu(t,n){var e=new Date;return t=+t,n=+n,function(r){return e.setTime(t*(1-r)+n*r),e}}function vt(t,n){return t=+t,n=+n,function(e){return t*(1-e)+n*e}}function Ju(t,n){var e={},r={},i;(t===null||typeof t!="object")&&(t={}),(n===null||typeof n!="object")&&(n={});for(i in n)i in t?e[i]=fe(t[i],n[i]):r[i]=n[i];return function(a){for(i in e)r[i]=e[i](a);return r}}var Ue=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,we=new RegExp(Ue.source,"g");function ju(t){return function(){return t}}function ts(t){return function(n){return t(n)+""}}function Yi(t,n){var e=Ue.lastIndex=we.lastIndex=0,r,i,a,o=-1,u=[],f=[];for(t=t+"",n=n+"";(r=Ue.exec(t))&&(i=we.exec(n));)(a=i.index)>e&&(a=n.slice(e,a),u[o]?u[o]+=a:u[++o]=a),(r=r[0])===(i=i[0])?u[o]?u[o]+=i:u[++o]=i:(u[++o]=null,f.push({i:o,x:vt(r,i)})),e=we.lastIndex;return e<n.length&&(a=n.slice(e),u[o]?u[o]+=a:u[++o]=a),u.length<2?f[0]?ts(f[0].x):ju(n):(n=f.length,function(s){for(var c=0,l;c<n;++c)u[(l=f[c]).i]=l.x(s);return u.join("")})}function fe(t,n){var e=typeof n,r;return n==null||e==="boolean"?rr(n):(e==="number"?vt:e==="string"?(r=qt(n))?(n=r,Zn):Yi:n instanceof qt?Zn:n instanceof Date?Qu:Xu(n)?Vu:Array.isArray(n)?Zu:typeof n.valueOf!="function"&&typeof n.toString!="function"||isNaN(n)?Ju:vt)(t,n)}function Li(t,n){return t=+t,n=+n,function(e){return Math.round(t*(1-e)+n*e)}}var Or=180/Math.PI,Ce={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Hi(t,n,e,r,i,a){var o,u,f;return(o=Math.sqrt(t*t+n*n))&&(t/=o,n/=o),(f=t*e+n*r)&&(e-=t*f,r-=n*f),(u=Math.sqrt(e*e+r*r))&&(e/=u,r/=u,f/=u),t*r<n*e&&(t=-t,n=-n,f=-f,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(n,t)*Or,skewX:Math.atan(f)*Or,scaleX:o,scaleY:u}}var $n;function ns(t){const n=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return n.isIdentity?Ce:Hi(n.a,n.b,n.c,n.d,n.e,n.f)}function es(t){return t==null||($n||($n=document.createElementNS("http://www.w3.org/2000/svg","g")),$n.setAttribute("transform",t),!(t=$n.transform.baseVal.consolidate()))?Ce:(t=t.matrix,Hi(t.a,t.b,t.c,t.d,t.e,t.f))}function Wi(t,n,e,r){function i(s){return s.length?s.pop()+" ":""}function a(s,c,l,h,g,p){if(s!==l||c!==h){var x=g.push("translate(",null,n,null,e);p.push({i:x-4,x:vt(s,l)},{i:x-2,x:vt(c,h)})}else(l||h)&&g.push("translate("+l+n+h+e)}function o(s,c,l,h){s!==c?(s-c>180?c+=360:c-s>180&&(s+=360),h.push({i:l.push(i(l)+"rotate(",null,r)-2,x:vt(s,c)})):c&&l.push(i(l)+"rotate("+c+r)}function u(s,c,l,h){s!==c?h.push({i:l.push(i(l)+"skewX(",null,r)-2,x:vt(s,c)}):c&&l.push(i(l)+"skewX("+c+r)}function f(s,c,l,h,g,p){if(s!==l||c!==h){var x=g.push(i(g)+"scale(",null,",",null,")");p.push({i:x-4,x:vt(s,l)},{i:x-2,x:vt(c,h)})}else(l!==1||h!==1)&&g.push(i(g)+"scale("+l+","+h+")")}return function(s,c){var l=[],h=[];return s=t(s),c=t(c),a(s.translateX,s.translateY,c.translateX,c.translateY,l,h),o(s.rotate,c.rotate,l,h),u(s.skewX,c.skewX,l,h),f(s.scaleX,s.scaleY,c.scaleX,c.scaleY,l,h),s=c=null,function(g){for(var p=-1,x=h.length,_;++p<x;)l[(_=h[p]).i]=_.x(g);return l.join("")}}}var rs=Wi(ns,"px, ","px)","deg)"),is=Wi(es,", ",")",")"),os=1e-12;function zr(t){return((t=Math.exp(t))+1/t)/2}function as(t){return((t=Math.exp(t))-1/t)/2}function us(t){return((t=Math.exp(2*t))-1)/(t+1)}const ss=function t(n,e,r){function i(a,o){var u=a[0],f=a[1],s=a[2],c=o[0],l=o[1],h=o[2],g=c-u,p=l-f,x=g*g+p*p,_,v;if(x<os)v=Math.log(h/s)/n,_=function(k){return[u+k*g,f+k*p,s*Math.exp(n*k*v)]};else{var b=Math.sqrt(x),M=(h*h-s*s+r*x)/(2*s*e*b),N=(h*h-s*s-r*x)/(2*h*e*b),D=Math.log(Math.sqrt(M*M+1)-M),w=Math.log(Math.sqrt(N*N+1)-N);v=(w-D)/n,_=function(k){var U=k*v,O=zr(D),z=s/(e*b)*(O*us(n*U+D)-as(D));return[u+z*g,f+z*p,s*O/zr(n*U+D)]}}return _.duration=v*1e3*n/Math.SQRT2,_}return i.rho=function(a){var o=Math.max(.001,+a),u=o*o,f=u*u;return t(o,u,f)},i}(Math.SQRT2,2,4);var en=0,pn=0,ln=0,qi=1e3,Qn,dn,Jn=0,Bt=0,he=0,xn=typeof performance=="object"&&performance.now?performance:Date,Bi=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ir(){return Bt||(Bi(ls),Bt=xn.now()+he)}function ls(){Bt=0}function jn(){this._call=this._time=this._next=null}jn.prototype=Ki.prototype={constructor:jn,restart:function(t,n,e){if(typeof t!="function")throw new TypeError("callback is not a function");e=(e==null?ir():+e)+(n==null?0:+n),!this._next&&dn!==this&&(dn?dn._next=this:Qn=this,dn=this),this._call=t,this._time=e,Oe()},stop:function(){this._call&&(this._call=null,this._time=1/0,Oe())}};function Ki(t,n,e){var r=new jn;return r.restart(t,n,e),r}function cs(){ir(),++en;for(var t=Qn,n;t;)(n=Bt-t._time)>=0&&t._call.call(void 0,n),t=t._next;--en}function Fr(){Bt=(Jn=xn.now())+he,en=pn=0;try{cs()}finally{en=0,hs(),Bt=0}}function fs(){var t=xn.now(),n=t-Jn;n>qi&&(he-=n,Jn=t)}function hs(){for(var t,n=Qn,e,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Qn=e);dn=t,Oe(r)}function Oe(t){if(!en){pn&&(pn=clearTimeout(pn));var n=t-Bt;n>24?(t<1/0&&(pn=setTimeout(Fr,t-xn.now()-he)),ln&&(ln=clearInterval(ln))):(ln||(Jn=xn.now(),ln=setInterval(fs,qi)),en=1,Bi(Fr))}}function Rr(t,n,e){var r=new jn;return n=n==null?0:+n,r.restart(i=>{r.stop(),t(i+n)},n,e),r}var gs=nr("start","end","cancel","interrupt"),ps=[],Gi=0,Pr=1,ze=2,Yn=3,Yr=4,Fe=5,Ln=6;function ge(t,n,e,r,i,a){var o=t.__transition;if(!o)t.__transition={};else if(e in o)return;ds(t,e,{name:n,index:r,group:i,on:gs,tween:ps,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:Gi})}function or(t,n){var e=_t(t,n);if(e.state>Gi)throw new Error("too late; already scheduled");return e}function Mt(t,n){var e=_t(t,n);if(e.state>Yn)throw new Error("too late; already running");return e}function _t(t,n){var e=t.__transition;if(!e||!(e=e[n]))throw new Error("transition not found");return e}function ds(t,n,e){var r=t.__transition,i;r[n]=e,e.timer=Ki(a,0,e.time);function a(s){e.state=Pr,e.timer.restart(o,e.delay,e.time),e.delay<=s&&o(s-e.delay)}function o(s){var c,l,h,g;if(e.state!==Pr)return f();for(c in r)if(g=r[c],g.name===e.name){if(g.state===Yn)return Rr(o);g.state===Yr?(g.state=Ln,g.timer.stop(),g.on.call("interrupt",t,t.__data__,g.index,g.group),delete r[c]):+c<n&&(g.state=Ln,g.timer.stop(),g.on.call("cancel",t,t.__data__,g.index,g.group),delete r[c])}if(Rr(function(){e.state===Yn&&(e.state=Yr,e.timer.restart(u,e.delay,e.time),u(s))}),e.state=ze,e.on.call("start",t,t.__data__,e.index,e.group),e.state===ze){for(e.state=Yn,i=new Array(h=e.tween.length),c=0,l=-1;c<h;++c)(g=e.tween[c].value.call(t,t.__data__,e.index,e.group))&&(i[++l]=g);i.length=l+1}}function u(s){for(var c=s<e.duration?e.ease.call(null,s/e.duration):(e.timer.restart(f),e.state=Fe,1),l=-1,h=i.length;++l<h;)i[l].call(t,c);e.state===Fe&&(e.on.call("end",t,t.__data__,e.index,e.group),f())}function f(){e.state=Ln,e.timer.stop(),delete r[n];for(var s in r)return;delete t.__transition}}function Hn(t,n){var e=t.__transition,r,i,a=!0,o;if(e){n=n==null?null:n+"";for(o in e){if((r=e[o]).name!==n){a=!1;continue}i=r.state>ze&&r.state<Fe,r.state=Ln,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete e[o]}a&&delete t.__transition}}function ms(t){return this.each(function(){Hn(this,t)})}function ys(t,n){var e,r;return function(){var i=Mt(this,t),a=i.tween;if(a!==e){r=e=a;for(var o=0,u=r.length;o<u;++o)if(r[o].name===n){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function vs(t,n,e){var r,i;if(typeof e!="function")throw new Error;return function(){var a=Mt(this,t),o=a.tween;if(o!==r){i=(r=o).slice();for(var u={name:n,value:e},f=0,s=i.length;f<s;++f)if(i[f].name===n){i[f]=u;break}f===s&&i.push(u)}a.tween=i}}function ws(t,n){var e=this._id;if(t+="",arguments.length<2){for(var r=_t(this.node(),e).tween,i=0,a=r.length,o;i<a;++i)if((o=r[i]).name===t)return o.value;return null}return this.each((n==null?ys:vs)(e,t,n))}function ar(t,n,e){var r=t._id;return t.each(function(){var i=Mt(this,r);(i.value||(i.value={}))[n]=e.apply(this,arguments)}),function(i){return _t(i,r).value[n]}}function Vi(t,n){var e;return(typeof n=="number"?vt:n instanceof qt?Zn:(e=qt(n))?(n=e,Zn):Yi)(t,n)}function _s(t){return function(){this.removeAttribute(t)}}function xs(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ms(t,n,e){var r,i=e+"",a;return function(){var o=this.getAttribute(t);return o===i?null:o===r?a:a=n(r=o,e)}}function Ns(t,n,e){var r,i=e+"",a;return function(){var o=this.getAttributeNS(t.space,t.local);return o===i?null:o===r?a:a=n(r=o,e)}}function bs(t,n,e){var r,i,a;return function(){var o,u=e(this),f;return u==null?void this.removeAttribute(t):(o=this.getAttribute(t),f=u+"",o===f?null:o===r&&f===i?a:(i=f,a=n(r=o,u)))}}function Ts(t,n,e){var r,i,a;return function(){var o,u=e(this),f;return u==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),f=u+"",o===f?null:o===r&&f===i?a:(i=f,a=n(r=o,u)))}}function Ss(t,n){var e=le(t),r=e==="transform"?is:Vi;return this.attrTween(t,typeof n=="function"?(e.local?Ts:bs)(e,r,ar(this,"attr."+t,n)):n==null?(e.local?xs:_s)(e):(e.local?Ns:Ms)(e,r,n))}function Ds(t,n){return function(e){this.setAttribute(t,n.call(this,e))}}function Es(t,n){return function(e){this.setAttributeNS(t.space,t.local,n.call(this,e))}}function ks(t,n){var e,r;function i(){var a=n.apply(this,arguments);return a!==r&&(e=(r=a)&&Es(t,a)),e}return i._value=n,i}function As(t,n){var e,r;function i(){var a=n.apply(this,arguments);return a!==r&&(e=(r=a)&&Ds(t,a)),e}return i._value=n,i}function $s(t,n){var e="attr."+t;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(n==null)return this.tween(e,null);if(typeof n!="function")throw new Error;var r=le(t);return this.tween(e,(r.local?ks:As)(r,n))}function Is(t,n){return function(){or(this,t).delay=+n.apply(this,arguments)}}function Us(t,n){return n=+n,function(){or(this,t).delay=n}}function Cs(t){var n=this._id;return arguments.length?this.each((typeof t=="function"?Is:Us)(n,t)):_t(this.node(),n).delay}function Os(t,n){return function(){Mt(this,t).duration=+n.apply(this,arguments)}}function zs(t,n){return n=+n,function(){Mt(this,t).duration=n}}function Fs(t){var n=this._id;return arguments.length?this.each((typeof t=="function"?Os:zs)(n,t)):_t(this.node(),n).duration}function Rs(t,n){if(typeof n!="function")throw new Error;return function(){Mt(this,t).ease=n}}function Ps(t){var n=this._id;return arguments.length?this.each(Rs(n,t)):_t(this.node(),n).ease}function Ys(t,n){return function(){var e=n.apply(this,arguments);if(typeof e!="function")throw new Error;Mt(this,t).ease=e}}function Ls(t){if(typeof t!="function")throw new Error;return this.each(Ys(this._id,t))}function Hs(t){typeof t!="function"&&(t=Di(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var a=n[i],o=a.length,u=r[i]=[],f,s=0;s<o;++s)(f=a[s])&&t.call(f,f.__data__,s,a)&&u.push(f);return new $t(r,this._parents,this._name,this._id)}function Ws(t){if(t._id!==this._id)throw new Error;for(var n=this._groups,e=t._groups,r=n.length,i=e.length,a=Math.min(r,i),o=new Array(r),u=0;u<a;++u)for(var f=n[u],s=e[u],c=f.length,l=o[u]=new Array(c),h,g=0;g<c;++g)(h=f[g]||s[g])&&(l[g]=h);for(;u<r;++u)o[u]=n[u];return new $t(o,this._parents,this._name,this._id)}function qs(t){return(t+"").trim().split(/^|\s+/).every(function(n){var e=n.indexOf(".");return e>=0&&(n=n.slice(0,e)),!n||n==="start"})}function Bs(t,n,e){var r,i,a=qs(n)?or:Mt;return function(){var o=a(this,t),u=o.on;u!==r&&(i=(r=u).copy()).on(n,e),o.on=i}}function Ks(t,n){var e=this._id;return arguments.length<2?_t(this.node(),e).on.on(t):this.each(Bs(e,t,n))}function Gs(t){return function(){var n=this.parentNode;for(var e in this.__transition)if(+e!==t)return;n&&n.removeChild(this)}}function Vs(){return this.on("end.remove",Gs(this._id))}function Xs(t){var n=this._name,e=this._id;typeof t!="function"&&(t=je(t));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var u=r[o],f=u.length,s=a[o]=new Array(f),c,l,h=0;h<f;++h)(c=u[h])&&(l=t.call(c,c.__data__,h,u))&&("__data__"in c&&(l.__data__=c.__data__),s[h]=l,ge(s[h],n,e,h,s,_t(c,e)));return new $t(a,this._parents,n,e)}function Zs(t){var n=this._name,e=this._id;typeof t!="function"&&(t=Si(t));for(var r=this._groups,i=r.length,a=[],o=[],u=0;u<i;++u)for(var f=r[u],s=f.length,c,l=0;l<s;++l)if(c=f[l]){for(var h=t.call(c,c.__data__,l,f),g,p=_t(c,e),x=0,_=h.length;x<_;++x)(g=h[x])&&ge(g,n,e,x,h,p);a.push(h),o.push(c)}return new $t(a,o,n,e)}var Qs=Sn.prototype.constructor;function Js(){return new Qs(this._groups,this._parents)}function js(t,n){var e,r,i;return function(){var a=nn(this,t),o=(this.style.removeProperty(t),nn(this,t));return a===o?null:a===e&&o===r?i:i=n(e=a,r=o)}}function Xi(t){return function(){this.style.removeProperty(t)}}function tl(t,n,e){var r,i=e+"",a;return function(){var o=nn(this,t);return o===i?null:o===r?a:a=n(r=o,e)}}function nl(t,n,e){var r,i,a;return function(){var o=nn(this,t),u=e(this),f=u+"";return u==null&&(f=u=(this.style.removeProperty(t),nn(this,t))),o===f?null:o===r&&f===i?a:(i=f,a=n(r=o,u))}}function el(t,n){var e,r,i,a="style."+n,o="end."+a,u;return function(){var f=Mt(this,t),s=f.on,c=f.value[a]==null?u||(u=Xi(n)):void 0;(s!==e||i!==c)&&(r=(e=s).copy()).on(o,i=c),f.on=r}}function rl(t,n,e){var r=(t+="")=="transform"?rs:Vi;return n==null?this.styleTween(t,js(t,r)).on("end.style."+t,Xi(t)):typeof n=="function"?this.styleTween(t,nl(t,r,ar(this,"style."+t,n))).each(el(this._id,t)):this.styleTween(t,tl(t,r,n),e).on("end.style."+t,null)}function il(t,n,e){return function(r){this.style.setProperty(t,n.call(this,r),e)}}function ol(t,n,e){var r,i;function a(){var o=n.apply(this,arguments);return o!==i&&(r=(i=o)&&il(t,o,e)),r}return a._value=n,a}function al(t,n,e){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(n==null)return this.tween(r,null);if(typeof n!="function")throw new Error;return this.tween(r,ol(t,n,e??""))}function ul(t){return function(){this.textContent=t}}function sl(t){return function(){var n=t(this);this.textContent=n??""}}function ll(t){return this.tween("text",typeof t=="function"?sl(ar(this,"text",t)):ul(t==null?"":t+""))}function cl(t){return function(n){this.textContent=t.call(this,n)}}function fl(t){var n,e;function r(){var i=t.apply(this,arguments);return i!==e&&(n=(e=i)&&cl(i)),n}return r._value=t,r}function hl(t){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,fl(t))}function gl(){for(var t=this._name,n=this._id,e=Zi(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],u=o.length,f,s=0;s<u;++s)if(f=o[s]){var c=_t(f,n);ge(f,t,e,s,o,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new $t(r,this._parents,t,e)}function pl(){var t,n,e=this,r=e._id,i=e.size();return new Promise(function(a,o){var u={value:o},f={value:function(){--i===0&&a()}};e.each(function(){var s=Mt(this,r),c=s.on;c!==t&&(n=(t=c).copy(),n._.cancel.push(u),n._.interrupt.push(u),n._.end.push(f)),s.on=n}),i===0&&a()})}var dl=0;function $t(t,n,e,r){this._groups=t,this._parents=n,this._name=e,this._id=r}function Zi(){return++dl}var Nt=Sn.prototype;$t.prototype={constructor:$t,select:Xs,selectAll:Zs,selectChild:Nt.selectChild,selectChildren:Nt.selectChildren,filter:Hs,merge:Ws,selection:Js,transition:gl,call:Nt.call,nodes:Nt.nodes,node:Nt.node,size:Nt.size,empty:Nt.empty,each:Nt.each,on:Ks,attr:Ss,attrTween:$s,style:rl,styleTween:al,text:ll,textTween:hl,remove:Vs,tween:ws,delay:Cs,duration:Fs,ease:Ps,easeVarying:Ls,end:pl,[Symbol.iterator]:Nt[Symbol.iterator]};function ml(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var yl={time:null,delay:0,duration:250,ease:ml};function vl(t,n){for(var e;!(e=t.__transition)||!(e=e[n]);)if(!(t=t.parentNode))throw new Error(`transition ${n} not found`);return e}function wl(t){var n,e;t instanceof $t?(n=t._id,t=t._name):(n=Zi(),(e=yl).time=ir(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],u=o.length,f,s=0;s<u;++s)(f=o[s])&&ge(f,t,n,s,o,e||vl(f,n));return new $t(r,this._parents,t,n)}Sn.prototype.interrupt=ms;Sn.prototype.transition=wl;const In=t=>()=>t;function _l(t,{sourceEvent:n,target:e,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:e,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Et(t,n,e){this.k=t,this.x=n,this.y=e}Et.prototype={constructor:Et,scale:function(t){return t===1?this:new Et(this.k*t,this.x,this.y)},translate:function(t,n){return t===0&n===0?this:new Et(this.k,this.x+this.k*t,this.y+this.k*n)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var ur=new Et(1,0,0);Et.prototype;function _e(t){t.stopImmediatePropagation()}function cn(t){t.preventDefault(),t.stopImmediatePropagation()}function xl(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function Ml(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function Lr(){return this.__zoom||ur}function Nl(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function bl(){return navigator.maxTouchPoints||"ontouchstart"in this}function Tl(t,n,e){var r=t.invertX(n[0][0])-e[0][0],i=t.invertX(n[1][0])-e[1][0],a=t.invertY(n[0][1])-e[0][1],o=t.invertY(n[1][1])-e[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o))}function Sl(){var t=xl,n=Ml,e=Tl,r=Nl,i=bl,a=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],u=250,f=ss,s=nr("start","zoom","end"),c,l,h,g=500,p=150,x=0,_=10;function v(d){d.property("__zoom",Lr).on("wheel.zoom",U,{passive:!1}).on("mousedown.zoom",O).on("dblclick.zoom",z).filter(i).on("touchstart.zoom",S).on("touchmove.zoom",P).on("touchend.zoom touchcancel.zoom",F).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}v.transform=function(d,m,y,E){var $=d.selection?d.selection():d;$.property("__zoom",Lr),d!==$?D(d,m,y,E):$.interrupt().each(function(){w(this,arguments).event(E).start().zoom(null,typeof m=="function"?m.apply(this,arguments):m).end()})},v.scaleBy=function(d,m,y,E){v.scaleTo(d,function(){var $=this.__zoom.k,I=typeof m=="function"?m.apply(this,arguments):m;return $*I},y,E)},v.scaleTo=function(d,m,y,E){v.transform(d,function(){var $=n.apply(this,arguments),I=this.__zoom,R=y==null?N($):typeof y=="function"?y.apply(this,arguments):y,Y=I.invert(R),B=typeof m=="function"?m.apply(this,arguments):m;return e(M(b(I,B),R,Y),$,o)},y,E)},v.translateBy=function(d,m,y,E){v.transform(d,function(){return e(this.__zoom.translate(typeof m=="function"?m.apply(this,arguments):m,typeof y=="function"?y.apply(this,arguments):y),n.apply(this,arguments),o)},null,E)},v.translateTo=function(d,m,y,E,$){v.transform(d,function(){var I=n.apply(this,arguments),R=this.__zoom,Y=E==null?N(I):typeof E=="function"?E.apply(this,arguments):E;return e(ur.translate(Y[0],Y[1]).scale(R.k).translate(typeof m=="function"?-m.apply(this,arguments):-m,typeof y=="function"?-y.apply(this,arguments):-y),I,o)},E,$)};function b(d,m){return m=Math.max(a[0],Math.min(a[1],m)),m===d.k?d:new Et(m,d.x,d.y)}function M(d,m,y){var E=m[0]-y[0]*d.k,$=m[1]-y[1]*d.k;return E===d.x&&$===d.y?d:new Et(d.k,E,$)}function N(d){return[(+d[0][0]+ +d[1][0])/2,(+d[0][1]+ +d[1][1])/2]}function D(d,m,y,E){d.on("start.zoom",function(){w(this,arguments).event(E).start()}).on("interrupt.zoom end.zoom",function(){w(this,arguments).event(E).end()}).tween("zoom",function(){var $=this,I=arguments,R=w($,I).event(E),Y=n.apply($,I),B=y==null?N(Y):typeof y=="function"?y.apply($,I):y,X=Math.max(Y[1][0]-Y[0][0],Y[1][1]-Y[0][1]),V=$.__zoom,j=typeof m=="function"?m.apply($,I):m,mt=f(V.invert(B).concat(X/V.k),j.invert(B).concat(X/j.k));return function(at){if(at===1)at=j;else{var yt=mt(at),A=X/yt[2];at=new Et(A,B[0]-yt[0]*A,B[1]-yt[1]*A)}R.zoom(null,at)}})}function w(d,m,y){return!y&&d.__zooming||new k(d,m)}function k(d,m){this.that=d,this.args=m,this.active=0,this.sourceEvent=null,this.extent=n.apply(d,m),this.taps=0}k.prototype={event:function(d){return d&&(this.sourceEvent=d),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(d,m){return this.mouse&&d!=="mouse"&&(this.mouse[1]=m.invert(this.mouse[0])),this.touch0&&d!=="touch"&&(this.touch0[1]=m.invert(this.touch0[0])),this.touch1&&d!=="touch"&&(this.touch1[1]=m.invert(this.touch1[0])),this.that.__zoom=m,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(d){var m=Dt(this.that).datum();s.call(d,this.that,new _l(d,{sourceEvent:this.sourceEvent,target:v,type:d,transform:this.that.__zoom,dispatch:s}),m)}};function U(d,...m){if(!t.apply(this,arguments))return;var y=w(this,m).event(d),E=this.__zoom,$=Math.max(a[0],Math.min(a[1],E.k*Math.pow(2,r.apply(this,arguments)))),I=zt(d);if(y.wheel)(y.mouse[0][0]!==I[0]||y.mouse[0][1]!==I[1])&&(y.mouse[1]=E.invert(y.mouse[0]=I)),clearTimeout(y.wheel);else{if(E.k===$)return;y.mouse=[I,E.invert(I)],Hn(this),y.start()}cn(d),y.wheel=setTimeout(R,p),y.zoom("mouse",e(M(b(E,$),y.mouse[0],y.mouse[1]),y.extent,o));function R(){y.wheel=null,y.end()}}function O(d,...m){if(h||!t.apply(this,arguments))return;var y=d.currentTarget,E=w(this,m,!0).event(d),$=Dt(d.view).on("mousemove.zoom",B,!0).on("mouseup.zoom",X,!0),I=zt(d,y),R=d.clientX,Y=d.clientY;Du(d.view),_e(d),E.mouse=[I,this.__zoom.invert(I)],Hn(this),E.start();function B(V){if(cn(V),!E.moved){var j=V.clientX-R,mt=V.clientY-Y;E.moved=j*j+mt*mt>x}E.event(V).zoom("mouse",e(M(E.that.__zoom,E.mouse[0]=zt(V,y),E.mouse[1]),E.extent,o))}function X(V){$.on("mousemove.zoom mouseup.zoom",null),Eu(V.view,E.moved),cn(V),E.event(V).end()}}function z(d,...m){if(t.apply(this,arguments)){var y=this.__zoom,E=zt(d.changedTouches?d.changedTouches[0]:d,this),$=y.invert(E),I=y.k*(d.shiftKey?.5:2),R=e(M(b(y,I),E,$),n.apply(this,m),o);cn(d),u>0?Dt(this).transition().duration(u).call(D,R,E,d):Dt(this).call(v.transform,R,E,d)}}function S(d,...m){if(t.apply(this,arguments)){var y=d.touches,E=y.length,$=w(this,m,d.changedTouches.length===E).event(d),I,R,Y,B;for(_e(d),R=0;R<E;++R)Y=y[R],B=zt(Y,this),B=[B,this.__zoom.invert(B),Y.identifier],$.touch0?!$.touch1&&$.touch0[2]!==B[2]&&($.touch1=B,$.taps=0):($.touch0=B,I=!0,$.taps=1+!!c);c&&(c=clearTimeout(c)),I&&($.taps<2&&(l=B[0],c=setTimeout(function(){c=null},g)),Hn(this),$.start())}}function P(d,...m){if(this.__zooming){var y=w(this,m).event(d),E=d.changedTouches,$=E.length,I,R,Y,B;for(cn(d),I=0;I<$;++I)R=E[I],Y=zt(R,this),y.touch0&&y.touch0[2]===R.identifier?y.touch0[0]=Y:y.touch1&&y.touch1[2]===R.identifier&&(y.touch1[0]=Y);if(R=y.that.__zoom,y.touch1){var X=y.touch0[0],V=y.touch0[1],j=y.touch1[0],mt=y.touch1[1],at=(at=j[0]-X[0])*at+(at=j[1]-X[1])*at,yt=(yt=mt[0]-V[0])*yt+(yt=mt[1]-V[1])*yt;R=b(R,Math.sqrt(at/yt)),Y=[(X[0]+j[0])/2,(X[1]+j[1])/2],B=[(V[0]+mt[0])/2,(V[1]+mt[1])/2]}else if(y.touch0)Y=y.touch0[0],B=y.touch0[1];else return;y.zoom("touch",e(M(R,Y,B),y.extent,o))}}function F(d,...m){if(this.__zooming){var y=w(this,m).event(d),E=d.changedTouches,$=E.length,I,R;for(_e(d),h&&clearTimeout(h),h=setTimeout(function(){h=null},g),I=0;I<$;++I)R=E[I],y.touch0&&y.touch0[2]===R.identifier?delete y.touch0:y.touch1&&y.touch1[2]===R.identifier&&delete y.touch1;if(y.touch1&&!y.touch0&&(y.touch0=y.touch1,delete y.touch1),y.touch0)y.touch0[1]=this.__zoom.invert(y.touch0[0]);else if(y.end(),y.taps===2&&(R=zt(R,this),Math.hypot(l[0]-R[0],l[1]-R[1])<_)){var Y=Dt(this).on("dblclick.zoom");Y&&Y.apply(this,arguments)}}}return v.wheelDelta=function(d){return arguments.length?(r=typeof d=="function"?d:In(+d),v):r},v.filter=function(d){return arguments.length?(t=typeof d=="function"?d:In(!!d),v):t},v.touchable=function(d){return arguments.length?(i=typeof d=="function"?d:In(!!d),v):i},v.extent=function(d){return arguments.length?(n=typeof d=="function"?d:In([[+d[0][0],+d[0][1]],[+d[1][0],+d[1][1]]]),v):n},v.scaleExtent=function(d){return arguments.length?(a[0]=+d[0],a[1]=+d[1],v):[a[0],a[1]]},v.translateExtent=function(d){return arguments.length?(o[0][0]=+d[0][0],o[1][0]=+d[1][0],o[0][1]=+d[0][1],o[1][1]=+d[1][1],v):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},v.constrain=function(d){return arguments.length?(e=d,v):e},v.duration=function(d){return arguments.length?(u=+d,v):u},v.interpolate=function(d){return arguments.length?(f=d,v):f},v.on=function(){var d=s.on.apply(s,arguments);return d===s?v:d},v.clickDistance=function(d){return arguments.length?(x=(d=+d)*d,v):Math.sqrt(x)},v.tapDistance=function(d){return arguments.length?(_=+d,v):_},v}class pe{constructor(n){C(this,"container");C(this,"width");C(this,"height");this.container=n,setTimeout(this.handler.bind(this),0),window.addEventListener("resize",this.handler.bind(this))}handler(){this.width=this.container.clientWidth,this.height=this.container.clientHeight,this.resize()}resize(){}}function Wn(t,n){return t==null||n==null?NaN:t<n?-1:t>n?1:t>=n?0:NaN}function Dl(t,n){return t==null||n==null?NaN:n<t?-1:n>t?1:n>=t?0:NaN}function sr(t){let n,e,r;t.length!==2?(n=Wn,e=(u,f)=>Wn(t(u),f),r=(u,f)=>t(u)-f):(n=t===Wn||t===Dl?t:El,e=t,r=t);function i(u,f,s=0,c=u.length){if(s<c){if(n(f,f)!==0)return c;do{const l=s+c>>>1;e(u[l],f)<0?s=l+1:c=l}while(s<c)}return s}function a(u,f,s=0,c=u.length){if(s<c){if(n(f,f)!==0)return c;do{const l=s+c>>>1;e(u[l],f)<=0?s=l+1:c=l}while(s<c)}return s}function o(u,f,s=0,c=u.length){const l=i(u,f,s,c-1);return l>s&&r(u[l-1],f)>-r(u[l],f)?l-1:l}return{left:i,center:o,right:a}}function El(){return 0}function kl(t){return t===null?NaN:+t}const Al=sr(Wn),$l=Al.right;sr(kl).center;class Il{constructor(){this._partials=new Float64Array(32),this._n=0}add(n){const e=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const a=e[i],o=n+a,u=Math.abs(n)<Math.abs(a)?n-(o-a):a-(o-n);u&&(e[r++]=u),n=o}return e[r]=n,this._n=r+1,this}valueOf(){const n=this._partials;let e=this._n,r,i,a,o=0;if(e>0){for(o=n[--e];e>0&&(r=o,i=n[--e],o=r+i,a=i-(o-r),!a););e>0&&(a<0&&n[e-1]<0||a>0&&n[e-1]>0)&&(i=a*2,r=o+i,i==r-o&&(o=r))}return o}}class Re extends Map{constructor(n,e=Ol){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),n!=null)for(const[r,i]of n)this.set(r,i)}get(n){return super.get(Hr(this,n))}has(n){return super.has(Hr(this,n))}set(n,e){return super.set(Ul(this,n),e)}delete(n){return super.delete(Cl(this,n))}}function Hr({_intern:t,_key:n},e){const r=n(e);return t.has(r)?t.get(r):e}function Ul({_intern:t,_key:n},e){const r=n(e);return t.has(r)?t.get(r):(t.set(r,e),e)}function Cl({_intern:t,_key:n},e){const r=n(e);return t.has(r)&&(e=t.get(r),t.delete(r)),e}function Ol(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Wr(t){return t}function lr(t,...n){return zl(t,Wr,Wr,n)}function zl(t,n,e,r){return function i(a,o){if(o>=r.length)return e(a);const u=new Re,f=r[o++];let s=-1;for(const c of a){const l=f(c,++s,a),h=u.get(l);h?h.push(c):u.set(l,[c])}for(const[c,l]of u)u.set(c,i(l,o));return n(u)}(t,0)}const Fl=Math.sqrt(50),Rl=Math.sqrt(10),Pl=Math.sqrt(2);function te(t,n,e){const r=(n-t)/Math.max(0,e),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=Fl?10:a>=Rl?5:a>=Pl?2:1;let u,f,s;return i<0?(s=Math.pow(10,-i)/o,u=Math.round(t*s),f=Math.round(n*s),u/s<t&&++u,f/s>n&&--f,s=-s):(s=Math.pow(10,i)*o,u=Math.round(t/s),f=Math.round(n/s),u*s<t&&++u,f*s>n&&--f),f<u&&.5<=e&&e<2?te(t,n,e*2):[u,f,s]}function Yl(t,n,e){if(n=+n,t=+t,e=+e,!(e>0))return[];if(t===n)return[t];const r=n<t,[i,a,o]=r?te(n,t,e):te(t,n,e);if(!(a>=i))return[];const u=a-i+1,f=new Array(u);if(r)if(o<0)for(let s=0;s<u;++s)f[s]=(a-s)/-o;else for(let s=0;s<u;++s)f[s]=(a-s)*o;else if(o<0)for(let s=0;s<u;++s)f[s]=(i+s)/-o;else for(let s=0;s<u;++s)f[s]=(i+s)*o;return f}function Pe(t,n,e){return n=+n,t=+t,e=+e,te(t,n,e)[2]}function Ye(t,n,e){n=+n,t=+t,e=+e;const r=n<t,i=r?Pe(n,t,e):Pe(t,n,e);return(r?-1:1)*(i<0?1/-i:i)}function Ll(t,n){let e;if(n===void 0)for(const r of t)r!=null&&(e<r||e===void 0&&r>=r)&&(e=r);else{let r=-1;for(let i of t)(i=n(i,++r,t))!=null&&(e<i||e===void 0&&i>=i)&&(e=i)}return e}function*Hl(t){for(const n of t)yield*n}function Qi(t){return Array.from(Hl(t))}function Ji(t,n,e){t=+t,n=+n,e=(i=arguments.length)<2?(n=t,t=0,1):i<3?1:+e;for(var r=-1,i=Math.max(0,Math.ceil((n-t)/e))|0,a=new Array(i);++r<i;)a[r]=t+r*e;return a}var G=1e-6,Wl=1e-12,H=Math.PI,ot=H/2,qr=H/4,dt=H*2,lt=180/H,tt=H/180,Z=Math.abs,ji=Math.atan,Mn=Math.atan2,Q=Math.cos,ql=Math.exp,Bl=Math.log,J=Math.sin,Kl=Math.sign||function(t){return t>0?1:t<0?-1:0},de=Math.sqrt,Gl=Math.tan;function Vl(t){return t>1?0:t<-1?H:Math.acos(t)}function Nn(t){return t>1?ot:t<-1?-ot:Math.asin(t)}function mn(){}function ne(t,n){t&&Kr.hasOwnProperty(t.type)&&Kr[t.type](t,n)}var Br={Feature:function(t,n){ne(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,r=-1,i=e.length;++r<i;)ne(e[r].geometry,n)}},Kr={Sphere:function(t,n){n.sphere()},Point:function(t,n){t=t.coordinates,n.point(t[0],t[1],t[2])},MultiPoint:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)t=e[r],n.point(t[0],t[1],t[2])},LineString:function(t,n){Le(t.coordinates,n,0)},MultiLineString:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)Le(e[r],n,0)},Polygon:function(t,n){Gr(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)Gr(e[r],n)},GeometryCollection:function(t,n){for(var e=t.geometries,r=-1,i=e.length;++r<i;)ne(e[r],n)}};function Le(t,n,e){var r=-1,i=t.length-e,a;for(n.lineStart();++r<i;)a=t[r],n.point(a[0],a[1],a[2]);n.lineEnd()}function Gr(t,n){var e=-1,r=t.length;for(n.polygonStart();++e<r;)Le(t[e],n,1);n.polygonEnd()}function Xl(t,n){t&&Br.hasOwnProperty(t.type)?Br[t.type](t,n):ne(t,n)}function He(t){return[Mn(t[1],t[0]),Nn(t[2])]}function rn(t){var n=t[0],e=t[1],r=Q(e);return[r*Q(n),r*J(n),J(e)]}function Un(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function ee(t,n){return[t[1]*n[2]-t[2]*n[1],t[2]*n[0]-t[0]*n[2],t[0]*n[1]-t[1]*n[0]]}function xe(t,n){t[0]+=n[0],t[1]+=n[1],t[2]+=n[2]}function Cn(t,n){return[t[0]*n,t[1]*n,t[2]*n]}function We(t){var n=de(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=n,t[1]/=n,t[2]/=n}function qe(t,n){function e(r,i){return r=t(r,i),n(r[0],r[1])}return t.invert&&n.invert&&(e.invert=function(r,i){return r=n.invert(r,i),r&&t.invert(r[0],r[1])}),e}function Be(t,n){return Z(t)>H&&(t-=Math.round(t/dt)*dt),[t,n]}Be.invert=Be;function to(t,n,e){return(t%=dt)?n||e?qe(Xr(t),Zr(n,e)):Xr(t):n||e?Zr(n,e):Be}function Vr(t){return function(n,e){return n+=t,Z(n)>H&&(n-=Math.round(n/dt)*dt),[n,e]}}function Xr(t){var n=Vr(t);return n.invert=Vr(-t),n}function Zr(t,n){var e=Q(t),r=J(t),i=Q(n),a=J(n);function o(u,f){var s=Q(f),c=Q(u)*s,l=J(u)*s,h=J(f),g=h*e+c*r;return[Mn(l*i-g*a,c*e-h*r),Nn(g*i+l*a)]}return o.invert=function(u,f){var s=Q(f),c=Q(u)*s,l=J(u)*s,h=J(f),g=h*i-l*a;return[Mn(l*i+h*a,c*e+g*r),Nn(g*e-c*r)]},o}function Zl(t){t=to(t[0]*tt,t[1]*tt,t.length>2?t[2]*tt:0);function n(e){return e=t(e[0]*tt,e[1]*tt),e[0]*=lt,e[1]*=lt,e}return n.invert=function(e){return e=t.invert(e[0]*tt,e[1]*tt),e[0]*=lt,e[1]*=lt,e},n}function Ql(t,n,e,r,i,a){if(e){var o=Q(n),u=J(n),f=r*e;i==null?(i=n+r*dt,a=n-f/2):(i=Qr(o,i),a=Qr(o,a),(r>0?i<a:i>a)&&(i+=r*dt));for(var s,c=i;r>0?c>a:c<a;c-=f)s=He([o,-u*Q(c),-u*J(c)]),t.point(s[0],s[1])}}function Qr(t,n){n=rn(n),n[0]-=t,We(n);var e=Vl(-n[1]);return((-n[2]<0?-e:e)+dt-G)%dt}function no(){var t=[],n;return{point:function(e,r,i){n.push([e,r,i])},lineStart:function(){t.push(n=[])},lineEnd:mn,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var e=t;return t=[],n=null,e}}}function qn(t,n){return Z(t[0]-n[0])<G&&Z(t[1]-n[1])<G}function On(t,n,e,r){this.x=t,this.z=n,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}function eo(t,n,e,r,i){var a=[],o=[],u,f;if(t.forEach(function(p){if(!((x=p.length-1)<=0)){var x,_=p[0],v=p[x],b;if(qn(_,v)){if(!_[2]&&!v[2]){for(i.lineStart(),u=0;u<x;++u)i.point((_=p[u])[0],_[1]);i.lineEnd();return}v[0]+=2*G}a.push(b=new On(_,p,null,!0)),o.push(b.o=new On(_,null,b,!1)),a.push(b=new On(v,p,null,!1)),o.push(b.o=new On(v,null,b,!0))}}),!!a.length){for(o.sort(n),Jr(a),Jr(o),u=0,f=o.length;u<f;++u)o[u].e=e=!e;for(var s=a[0],c,l;;){for(var h=s,g=!0;h.v;)if((h=h.n)===s)return;c=h.z,i.lineStart();do{if(h.v=h.o.v=!0,h.e){if(g)for(u=0,f=c.length;u<f;++u)i.point((l=c[u])[0],l[1]);else r(h.x,h.n.x,1,i);h=h.n}else{if(g)for(c=h.p.z,u=c.length-1;u>=0;--u)i.point((l=c[u])[0],l[1]);else r(h.x,h.p.x,-1,i);h=h.p}h=h.o,c=h.z,g=!g}while(!h.v);i.lineEnd()}}}function Jr(t){if(n=t.length){for(var n,e=0,r=t[0],i;++e<n;)r.n=i=t[e],i.p=r,r=i;r.n=i=t[0],i.p=r}}function Me(t){return Z(t[0])<=H?t[0]:Kl(t[0])*((Z(t[0])+H)%dt-H)}function Jl(t,n){var e=Me(n),r=n[1],i=J(r),a=[J(e),-Q(e),0],o=0,u=0,f=new Il;i===1?r=ot+G:i===-1&&(r=-ot-G);for(var s=0,c=t.length;s<c;++s)if(h=(l=t[s]).length)for(var l,h,g=l[h-1],p=Me(g),x=g[1]/2+qr,_=J(x),v=Q(x),b=0;b<h;++b,p=N,_=w,v=k,g=M){var M=l[b],N=Me(M),D=M[1]/2+qr,w=J(D),k=Q(D),U=N-p,O=U>=0?1:-1,z=O*U,S=z>H,P=_*w;if(f.add(Mn(P*O*J(z),v*k+P*Q(z))),o+=S?U+O*dt:U,S^p>=e^N>=e){var F=ee(rn(g),rn(M));We(F);var d=ee(a,F);We(d);var m=(S^U>=0?-1:1)*Nn(d[2]);(r>m||r===m&&(F[0]||F[1]))&&(u+=S^U>=0?1:-1)}}return(o<-G||o<G&&f<-Wl)^u&1}function ro(t,n,e,r){return function(i){var a=n(i),o=no(),u=n(o),f=!1,s,c,l,h={point:g,lineStart:x,lineEnd:_,polygonStart:function(){h.point=v,h.lineStart=b,h.lineEnd=M,c=[],s=[]},polygonEnd:function(){h.point=g,h.lineStart=x,h.lineEnd=_,c=Qi(c);var N=Jl(s,r);c.length?(f||(i.polygonStart(),f=!0),eo(c,tc,N,e,i)):N&&(f||(i.polygonStart(),f=!0),i.lineStart(),e(null,null,1,i),i.lineEnd()),f&&(i.polygonEnd(),f=!1),c=s=null},sphere:function(){i.polygonStart(),i.lineStart(),e(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function g(N,D){t(N,D)&&i.point(N,D)}function p(N,D){a.point(N,D)}function x(){h.point=p,a.lineStart()}function _(){h.point=g,a.lineEnd()}function v(N,D){l.push([N,D]),u.point(N,D)}function b(){u.lineStart(),l=[]}function M(){v(l[0][0],l[0][1]),u.lineEnd();var N=u.clean(),D=o.result(),w,k=D.length,U,O,z;if(l.pop(),s.push(l),l=null,!!k){if(N&1){if(O=D[0],(U=O.length-1)>0){for(f||(i.polygonStart(),f=!0),i.lineStart(),w=0;w<U;++w)i.point((z=O[w])[0],z[1]);i.lineEnd()}return}k>1&&N&2&&D.push(D.pop().concat(D.shift())),c.push(D.filter(jl))}}return h}}function jl(t){return t.length>1}function tc(t,n){return((t=t.x)[0]<0?t[1]-ot-G:ot-t[1])-((n=n.x)[0]<0?n[1]-ot-G:ot-n[1])}const jr=ro(function(){return!0},nc,rc,[-H,-ot]);function nc(t){var n=NaN,e=NaN,r=NaN,i;return{lineStart:function(){t.lineStart(),i=1},point:function(a,o){var u=a>0?H:-H,f=Z(a-n);Z(f-H)<G?(t.point(n,e=(e+o)/2>0?ot:-ot),t.point(r,e),t.lineEnd(),t.lineStart(),t.point(u,e),t.point(a,e),i=0):r!==u&&f>=H&&(Z(n-r)<G&&(n-=r*G),Z(a-u)<G&&(a-=u*G),e=ec(n,e,a,o),t.point(r,e),t.lineEnd(),t.lineStart(),t.point(u,e),i=0),t.point(n=a,e=o),r=u},lineEnd:function(){t.lineEnd(),n=e=NaN},clean:function(){return 2-i}}}function ec(t,n,e,r){var i,a,o=J(t-e);return Z(o)>G?ji((J(n)*(a=Q(r))*J(e)-J(r)*(i=Q(n))*J(t))/(i*a*o)):(n+r)/2}function rc(t,n,e,r){var i;if(t==null)i=e*ot,r.point(-H,i),r.point(0,i),r.point(H,i),r.point(H,0),r.point(H,-i),r.point(0,-i),r.point(-H,-i),r.point(-H,0),r.point(-H,i);else if(Z(t[0]-n[0])>G){var a=t[0]<n[0]?H:-H;i=e*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(n[0],n[1])}function ic(t){var n=Q(t),e=2*tt,r=n>0,i=Z(n)>G;function a(c,l,h,g){Ql(g,t,e,h,c,l)}function o(c,l){return Q(c)*Q(l)>n}function u(c){var l,h,g,p,x;return{lineStart:function(){p=g=!1,x=1},point:function(_,v){var b=[_,v],M,N=o(_,v),D=r?N?0:s(_,v):N?s(_+(_<0?H:-H),v):0;if(!l&&(p=g=N)&&c.lineStart(),N!==g&&(M=f(l,b),(!M||qn(l,M)||qn(b,M))&&(b[2]=1)),N!==g)x=0,N?(c.lineStart(),M=f(b,l),c.point(M[0],M[1])):(M=f(l,b),c.point(M[0],M[1],2),c.lineEnd()),l=M;else if(i&&l&&r^N){var w;!(D&h)&&(w=f(b,l,!0))&&(x=0,r?(c.lineStart(),c.point(w[0][0],w[0][1]),c.point(w[1][0],w[1][1]),c.lineEnd()):(c.point(w[1][0],w[1][1]),c.lineEnd(),c.lineStart(),c.point(w[0][0],w[0][1],3)))}N&&(!l||!qn(l,b))&&c.point(b[0],b[1]),l=b,g=N,h=D},lineEnd:function(){g&&c.lineEnd(),l=null},clean:function(){return x|(p&&g)<<1}}}function f(c,l,h){var g=rn(c),p=rn(l),x=[1,0,0],_=ee(g,p),v=Un(_,_),b=_[0],M=v-b*b;if(!M)return!h&&c;var N=n*v/M,D=-n*b/M,w=ee(x,_),k=Cn(x,N),U=Cn(_,D);xe(k,U);var O=w,z=Un(k,O),S=Un(O,O),P=z*z-S*(Un(k,k)-1);if(!(P<0)){var F=de(P),d=Cn(O,(-z-F)/S);if(xe(d,k),d=He(d),!h)return d;var m=c[0],y=l[0],E=c[1],$=l[1],I;y<m&&(I=m,m=y,y=I);var R=y-m,Y=Z(R-H)<G,B=Y||R<G;if(!Y&&$<E&&(I=E,E=$,$=I),B?Y?E+$>0^d[1]<(Z(d[0]-m)<G?E:$):E<=d[1]&&d[1]<=$:R>H^(m<=d[0]&&d[0]<=y)){var X=Cn(O,(-z+F)/S);return xe(X,k),[d,He(X)]}}}function s(c,l){var h=r?t:H-t,g=0;return c<-h?g|=1:c>h&&(g|=2),l<-h?g|=4:l>h&&(g|=8),g}return ro(o,u,a,r?[0,-t]:[-H,t-H])}function oc(t,n,e,r,i,a){var o=t[0],u=t[1],f=n[0],s=n[1],c=0,l=1,h=f-o,g=s-u,p;if(p=e-o,!(!h&&p>0)){if(p/=h,h<0){if(p<c)return;p<l&&(l=p)}else if(h>0){if(p>l)return;p>c&&(c=p)}if(p=i-o,!(!h&&p<0)){if(p/=h,h<0){if(p>l)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<l&&(l=p)}if(p=r-u,!(!g&&p>0)){if(p/=g,g<0){if(p<c)return;p<l&&(l=p)}else if(g>0){if(p>l)return;p>c&&(c=p)}if(p=a-u,!(!g&&p<0)){if(p/=g,g<0){if(p>l)return;p>c&&(c=p)}else if(g>0){if(p<c)return;p<l&&(l=p)}return c>0&&(t[0]=o+c*h,t[1]=u+c*g),l<1&&(n[0]=o+l*h,n[1]=u+l*g),!0}}}}}var yn=1e9,zn=-yn;function ac(t,n,e,r){function i(s,c){return t<=s&&s<=e&&n<=c&&c<=r}function a(s,c,l,h){var g=0,p=0;if(s==null||(g=o(s,l))!==(p=o(c,l))||f(s,c)<0^l>0)do h.point(g===0||g===3?t:e,g>1?r:n);while((g=(g+l+4)%4)!==p);else h.point(c[0],c[1])}function o(s,c){return Z(s[0]-t)<G?c>0?0:3:Z(s[0]-e)<G?c>0?2:1:Z(s[1]-n)<G?c>0?1:0:c>0?3:2}function u(s,c){return f(s.x,c.x)}function f(s,c){var l=o(s,1),h=o(c,1);return l!==h?l-h:l===0?c[1]-s[1]:l===1?s[0]-c[0]:l===2?s[1]-c[1]:c[0]-s[0]}return function(s){var c=s,l=no(),h,g,p,x,_,v,b,M,N,D,w,k={point:U,lineStart:P,lineEnd:F,polygonStart:z,polygonEnd:S};function U(m,y){i(m,y)&&c.point(m,y)}function O(){for(var m=0,y=0,E=g.length;y<E;++y)for(var $=g[y],I=1,R=$.length,Y=$[0],B,X,V=Y[0],j=Y[1];I<R;++I)B=V,X=j,Y=$[I],V=Y[0],j=Y[1],X<=r?j>r&&(V-B)*(r-X)>(j-X)*(t-B)&&++m:j<=r&&(V-B)*(r-X)<(j-X)*(t-B)&&--m;return m}function z(){c=l,h=[],g=[],w=!0}function S(){var m=O(),y=w&&m,E=(h=Qi(h)).length;(y||E)&&(s.polygonStart(),y&&(s.lineStart(),a(null,null,1,s),s.lineEnd()),E&&eo(h,u,m,a,s),s.polygonEnd()),c=s,h=g=p=null}function P(){k.point=d,g&&g.push(p=[]),D=!0,N=!1,b=M=NaN}function F(){h&&(d(x,_),v&&N&&l.rejoin(),h.push(l.result())),k.point=U,N&&c.lineEnd()}function d(m,y){var E=i(m,y);if(g&&p.push([m,y]),D)x=m,_=y,v=E,D=!1,E&&(c.lineStart(),c.point(m,y));else if(E&&N)c.point(m,y);else{var $=[b=Math.max(zn,Math.min(yn,b)),M=Math.max(zn,Math.min(yn,M))],I=[m=Math.max(zn,Math.min(yn,m)),y=Math.max(zn,Math.min(yn,y))];oc($,I,t,n,e,r)?(N||(c.lineStart(),c.point($[0],$[1])),c.point(I[0],I[1]),E||c.lineEnd(),w=!1):E&&(c.lineStart(),c.point(m,y),w=!1)}b=m,M=y,N=E}return k}}const ti=t=>t;var on=1/0,re=on,bn=-on,ie=bn,ni={point:uc,lineStart:mn,lineEnd:mn,polygonStart:mn,polygonEnd:mn,result:function(){var t=[[on,re],[bn,ie]];return bn=ie=-(re=on=1/0),t}};function uc(t,n){t<on&&(on=t),t>bn&&(bn=t),n<re&&(re=n),n>ie&&(ie=n)}function cr(t){return function(n){var e=new Ke;for(var r in t)e[r]=t[r];return e.stream=n,e}}function Ke(){}Ke.prototype={constructor:Ke,point:function(t,n){this.stream.point(t,n)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function fr(t,n,e){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),r!=null&&t.clipExtent(null),Xl(e,t.stream(ni)),n(ni.result()),r!=null&&t.clipExtent(r),t}function io(t,n,e){return fr(t,function(r){var i=n[1][0]-n[0][0],a=n[1][1]-n[0][1],o=Math.min(i/(r[1][0]-r[0][0]),a/(r[1][1]-r[0][1])),u=+n[0][0]+(i-o*(r[1][0]+r[0][0]))/2,f=+n[0][1]+(a-o*(r[1][1]+r[0][1]))/2;t.scale(150*o).translate([u,f])},e)}function sc(t,n,e){return io(t,[[0,0],n],e)}function lc(t,n,e){return fr(t,function(r){var i=+n,a=i/(r[1][0]-r[0][0]),o=(i-a*(r[1][0]+r[0][0]))/2,u=-a*r[0][1];t.scale(150*a).translate([o,u])},e)}function cc(t,n,e){return fr(t,function(r){var i=+n,a=i/(r[1][1]-r[0][1]),o=-a*r[0][0],u=(i-a*(r[1][1]+r[0][1]))/2;t.scale(150*a).translate([o,u])},e)}var ei=16,fc=Q(30*tt);function ri(t,n){return+n?gc(t,n):hc(t)}function hc(t){return cr({point:function(n,e){n=t(n,e),this.stream.point(n[0],n[1])}})}function gc(t,n){function e(r,i,a,o,u,f,s,c,l,h,g,p,x,_){var v=s-r,b=c-i,M=v*v+b*b;if(M>4*n&&x--){var N=o+h,D=u+g,w=f+p,k=de(N*N+D*D+w*w),U=Nn(w/=k),O=Z(Z(w)-1)<G||Z(a-l)<G?(a+l)/2:Mn(D,N),z=t(O,U),S=z[0],P=z[1],F=S-r,d=P-i,m=b*F-v*d;(m*m/M>n||Z((v*F+b*d)/M-.5)>.3||o*h+u*g+f*p<fc)&&(e(r,i,a,o,u,f,S,P,O,N/=k,D/=k,w,x,_),_.point(S,P),e(S,P,O,N,D,w,s,c,l,h,g,p,x,_))}}return function(r){var i,a,o,u,f,s,c,l,h,g,p,x,_={point:v,lineStart:b,lineEnd:N,polygonStart:function(){r.polygonStart(),_.lineStart=D},polygonEnd:function(){r.polygonEnd(),_.lineStart=b}};function v(U,O){U=t(U,O),r.point(U[0],U[1])}function b(){l=NaN,_.point=M,r.lineStart()}function M(U,O){var z=rn([U,O]),S=t(U,O);e(l,h,c,g,p,x,l=S[0],h=S[1],c=U,g=z[0],p=z[1],x=z[2],ei,r),r.point(l,h)}function N(){_.point=v,r.lineEnd()}function D(){b(),_.point=w,_.lineEnd=k}function w(U,O){M(i=U,O),a=l,o=h,u=g,f=p,s=x,_.point=M}function k(){e(l,h,c,g,p,x,a,o,i,u,f,s,ei,r),_.lineEnd=N,N()}return _}}var pc=cr({point:function(t,n){this.stream.point(t*tt,n*tt)}});function dc(t){return cr({point:function(n,e){var r=t(n,e);return this.stream.point(r[0],r[1])}})}function mc(t,n,e,r,i){function a(o,u){return o*=r,u*=i,[n+t*o,e-t*u]}return a.invert=function(o,u){return[(o-n)/t*r,(e-u)/t*i]},a}function ii(t,n,e,r,i,a){if(!a)return mc(t,n,e,r,i);var o=Q(a),u=J(a),f=o*t,s=u*t,c=o/t,l=u/t,h=(u*e-o*n)/t,g=(u*n+o*e)/t;function p(x,_){return x*=r,_*=i,[f*x-s*_+n,e-s*x-f*_]}return p.invert=function(x,_){return[r*(c*x-l*_+h),i*(g-l*x-c*_)]},p}function yc(t){return vc(function(){return t})()}function vc(t){var n,e=150,r=480,i=250,a=0,o=0,u=0,f=0,s=0,c,l=0,h=1,g=1,p=null,x=jr,_=null,v,b,M,N=ti,D=.5,w,k,U,O,z;function S(m){return U(m[0]*tt,m[1]*tt)}function P(m){return m=U.invert(m[0],m[1]),m&&[m[0]*lt,m[1]*lt]}S.stream=function(m){return O&&z===m?O:O=pc(dc(c)(x(w(N(z=m)))))},S.preclip=function(m){return arguments.length?(x=m,p=void 0,d()):x},S.postclip=function(m){return arguments.length?(N=m,_=v=b=M=null,d()):N},S.clipAngle=function(m){return arguments.length?(x=+m?ic(p=m*tt):(p=null,jr),d()):p*lt},S.clipExtent=function(m){return arguments.length?(N=m==null?(_=v=b=M=null,ti):ac(_=+m[0][0],v=+m[0][1],b=+m[1][0],M=+m[1][1]),d()):_==null?null:[[_,v],[b,M]]},S.scale=function(m){return arguments.length?(e=+m,F()):e},S.translate=function(m){return arguments.length?(r=+m[0],i=+m[1],F()):[r,i]},S.center=function(m){return arguments.length?(a=m[0]%360*tt,o=m[1]%360*tt,F()):[a*lt,o*lt]},S.rotate=function(m){return arguments.length?(u=m[0]%360*tt,f=m[1]%360*tt,s=m.length>2?m[2]%360*tt:0,F()):[u*lt,f*lt,s*lt]},S.angle=function(m){return arguments.length?(l=m%360*tt,F()):l*lt},S.reflectX=function(m){return arguments.length?(h=m?-1:1,F()):h<0},S.reflectY=function(m){return arguments.length?(g=m?-1:1,F()):g<0},S.precision=function(m){return arguments.length?(w=ri(k,D=m*m),d()):de(D)},S.fitExtent=function(m,y){return io(S,m,y)},S.fitSize=function(m,y){return sc(S,m,y)},S.fitWidth=function(m,y){return lc(S,m,y)},S.fitHeight=function(m,y){return cc(S,m,y)};function F(){var m=ii(e,0,0,h,g,l).apply(null,n(a,o)),y=ii(e,r-m[0],i-m[1],h,g,l);return c=to(u,f,s),k=qe(n,y),U=qe(c,k),w=ri(k,D),d()}function d(){return O=z=null,S}return function(){return n=t.apply(this,arguments),S.invert=n.invert&&P,F()}}function hr(t,n){return[t,Bl(Gl((ot+n)/2))]}hr.invert=function(t,n){return[t,2*ji(ql(n))-ot]};function wc(){return _c(hr).scale(961/dt)}function _c(t){var n=yc(t),e=n.center,r=n.scale,i=n.translate,a=n.clipExtent,o=null,u,f,s;n.scale=function(l){return arguments.length?(r(l),c()):r()},n.translate=function(l){return arguments.length?(i(l),c()):i()},n.center=function(l){return arguments.length?(e(l),c()):e()},n.clipExtent=function(l){return arguments.length?(l==null?o=u=f=s=null:(o=+l[0][0],u=+l[0][1],f=+l[1][0],s=+l[1][1]),c()):o==null?null:[[o,u],[f,s]]};function c(){var l=H*r(),h=n(Zl(n.rotate()).invert([0,0]));return a(o==null?[[h[0]-l,h[1]-l],[h[0]+l,h[1]+l]]:t===hr?[[Math.max(h[0]-l,o),u],[Math.min(h[0]+l,f),s]]:[[o,Math.max(h[1]-l,u)],[f,Math.min(h[1]+l,s)]])}return c()}var Jt=Math.PI/3,xc=[0,Jt,2*Jt,3*Jt,4*Jt,5*Jt];function Mc(t){return t[0]}function Nc(t){return t[1]}function bc(){var t=0,n=0,e=1,r=1,i=Mc,a=Nc,o,u,f;function s(l){var h={},g=[],p,x=l.length;for(p=0;p<x;++p)if(!(isNaN(v=+i.call(null,_=l[p],p,l))||isNaN(b=+a.call(null,_,p,l)))){var _,v,b,M=Math.round(b=b/f),N=Math.round(v=v/u-(M&1)/2),D=b-M;if(Math.abs(D)*3>1){var w=v-N,k=N+(v<N?-1:1)/2,U=M+(b<M?-1:1),O=v-k,z=b-U;w*w+D*D>O*O+z*z&&(N=k+(M&1?1:-1)/2,M=U)}var S=N+"-"+M,P=h[S];P?P.push(_):(g.push(P=h[S]=[_]),P.x=(N+(M&1)/2)*u,P.y=M*f)}return g}function c(l){var h=0,g=0;return xc.map(function(p){var x=Math.sin(p)*l,_=-Math.cos(p)*l,v=x-h,b=_-g;return h=x,g=_,[v,b]})}return s.hexagon=function(l){return"m"+c(l==null?o:+l).join("l")+"z"},s.centers=function(){for(var l=[],h=Math.round(n/f),g=Math.round(t/u),p=h*f;p<r+o;p+=f,++h)for(var x=g*u+(h&1)*u/2;x<e+u/2;x+=u)l.push([x,p]);return l},s.mesh=function(){var l=c(o).slice(0,4).join("l");return s.centers().map(function(h){return"M"+h+"m"+l}).join("")},s.x=function(l){return arguments.length?(i=l,s):i},s.y=function(l){return arguments.length?(a=l,s):a},s.radius=function(l){return arguments.length?(o=+l,u=o*2*Math.sin(Jt),f=o*1.5,s):o},s.size=function(l){return arguments.length?(t=n=0,e=+l[0],r=+l[1],s):[e-t,r-n]},s.extent=function(l){return arguments.length?(t=+l[0][0],n=+l[0][1],e=+l[1][0],r=+l[1][1],s):[[t,n],[e,r]]},s.radius(1)}function En(t,n){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(n).domain(t);break}return this}function Tc(t,n){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof n=="function"?this.interpolator(n):this.range(n);break}}return this}const oi=Symbol("implicit");function gr(){var t=new Re,n=[],e=[],r=oi;function i(a){let o=t.get(a);if(o===void 0){if(r!==oi)return r;t.set(a,o=n.push(a)-1)}return e[o%e.length]}return i.domain=function(a){if(!arguments.length)return n.slice();n=[],t=new Re;for(const o of a)t.has(o)||t.set(o,n.push(o)-1);return i},i.range=function(a){return arguments.length?(e=Array.from(a),i):e.slice()},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return gr(n,e).unknown(r)},En.apply(i,arguments),i}function oo(){var t=gr().unknown(void 0),n=t.domain,e=t.range,r=0,i=1,a,o,u=!1,f=0,s=0,c=.5;delete t.unknown;function l(){var h=n().length,g=i<r,p=g?i:r,x=g?r:i;a=(x-p)/Math.max(1,h-f+s*2),u&&(a=Math.floor(a)),p+=(x-p-a*(h-f))*c,o=a*(1-f),u&&(p=Math.round(p),o=Math.round(o));var _=Ji(h).map(function(v){return p+a*v});return e(g?_.reverse():_)}return t.domain=function(h){return arguments.length?(n(h),l()):n()},t.range=function(h){return arguments.length?([r,i]=h,r=+r,i=+i,l()):[r,i]},t.rangeRound=function(h){return[r,i]=h,r=+r,i=+i,u=!0,l()},t.bandwidth=function(){return o},t.step=function(){return a},t.round=function(h){return arguments.length?(u=!!h,l()):u},t.padding=function(h){return arguments.length?(f=Math.min(1,s=+h),l()):f},t.paddingInner=function(h){return arguments.length?(f=Math.min(1,h),l()):f},t.paddingOuter=function(h){return arguments.length?(s=+h,l()):s},t.align=function(h){return arguments.length?(c=Math.max(0,Math.min(1,h)),l()):c},t.copy=function(){return oo(n(),[r,i]).round(u).paddingInner(f).paddingOuter(s).align(c)},En.apply(l(),arguments)}function Sc(t){return function(){return t}}function Dc(t){return+t}var ai=[0,1];function ht(t){return t}function Ge(t,n){return(n-=t=+t)?function(e){return(e-t)/n}:Sc(isNaN(n)?NaN:.5)}function Ec(t,n){var e;return t>n&&(e=t,t=n,n=e),function(r){return Math.max(t,Math.min(n,r))}}function kc(t,n,e){var r=t[0],i=t[1],a=n[0],o=n[1];return i<r?(r=Ge(i,r),a=e(o,a)):(r=Ge(r,i),a=e(a,o)),function(u){return a(r(u))}}function Ac(t,n,e){var r=Math.min(t.length,n.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++o<r;)i[o]=Ge(t[o],t[o+1]),a[o]=e(n[o],n[o+1]);return function(u){var f=$l(t,u,1,r)-1;return a[f](i[f](u))}}function pr(t,n){return n.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function ao(){var t=ai,n=ai,e=fe,r,i,a,o=ht,u,f,s;function c(){var h=Math.min(t.length,n.length);return o!==ht&&(o=Ec(t[0],t[h-1])),u=h>2?Ac:kc,f=s=null,l}function l(h){return h==null||isNaN(h=+h)?a:(f||(f=u(t.map(r),n,e)))(r(o(h)))}return l.invert=function(h){return o(i((s||(s=u(n,t.map(r),vt)))(h)))},l.domain=function(h){return arguments.length?(t=Array.from(h,Dc),c()):t.slice()},l.range=function(h){return arguments.length?(n=Array.from(h),c()):n.slice()},l.rangeRound=function(h){return n=Array.from(h),e=Li,c()},l.clamp=function(h){return arguments.length?(o=h?!0:ht,c()):o!==ht},l.interpolate=function(h){return arguments.length?(e=h,c()):e},l.unknown=function(h){return arguments.length?(a=h,l):a},function(h,g){return r=h,i=g,c()}}function uo(){return ao()(ht,ht)}function $c(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function oe(t,n){if((e=(t=n?t.toExponential(n-1):t.toExponential()).indexOf("e"))<0)return null;var e,r=t.slice(0,e);return[r.length>1?r[0]+r.slice(2):r,+t.slice(e+1)]}function an(t){return t=oe(Math.abs(t)),t?t[1]:NaN}function Ic(t,n){return function(e,r){for(var i=e.length,a=[],o=0,u=t[0],f=0;i>0&&u>0&&(f+u+1>r&&(u=Math.max(1,r-f)),a.push(e.substring(i-=u,i+u)),!((f+=u+1)>r));)u=t[o=(o+1)%t.length];return a.reverse().join(n)}}function Uc(t){return function(n){return n.replace(/[0-9]/g,function(e){return t[+e]})}}var Cc=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ae(t){if(!(n=Cc.exec(t)))throw new Error("invalid format: "+t);var n;return new dr({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}ae.prototype=dr.prototype;function dr(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}dr.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Oc(t){t:for(var n=t.length,e=1,r=-1,i;e<n;++e)switch(t[e]){case".":r=i=e;break;case"0":r===0&&(r=e),i=e;break;default:if(!+t[e])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var so;function zc(t,n){var e=oe(t,n);if(!e)return t+"";var r=e[0],i=e[1],a=i-(so=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+oe(t,Math.max(0,n+a-1))[0]}function ui(t,n){var e=oe(t,n);if(!e)return t+"";var r=e[0],i=e[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const si={"%":(t,n)=>(t*100).toFixed(n),b:t=>Math.round(t).toString(2),c:t=>t+"",d:$c,e:(t,n)=>t.toExponential(n),f:(t,n)=>t.toFixed(n),g:(t,n)=>t.toPrecision(n),o:t=>Math.round(t).toString(8),p:(t,n)=>ui(t*100,n),r:ui,s:zc,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function li(t){return t}var ci=Array.prototype.map,fi=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Fc(t){var n=t.grouping===void 0||t.thousands===void 0?li:Ic(ci.call(t.grouping,Number),t.thousands+""),e=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?li:Uc(ci.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",u=t.minus===void 0?"":t.minus+"",f=t.nan===void 0?"NaN":t.nan+"";function s(l){l=ae(l);var h=l.fill,g=l.align,p=l.sign,x=l.symbol,_=l.zero,v=l.width,b=l.comma,M=l.precision,N=l.trim,D=l.type;D==="n"?(b=!0,D="g"):si[D]||(M===void 0&&(M=12),N=!0,D="g"),(_||h==="0"&&g==="=")&&(_=!0,h="0",g="=");var w=x==="$"?e:x==="#"&&/[boxX]/.test(D)?"0"+D.toLowerCase():"",k=x==="$"?r:/[%p]/.test(D)?o:"",U=si[D],O=/[defgprs%]/.test(D);M=M===void 0?6:/[gprs]/.test(D)?Math.max(1,Math.min(21,M)):Math.max(0,Math.min(20,M));function z(S){var P=w,F=k,d,m,y;if(D==="c")F=U(S)+F,S="";else{S=+S;var E=S<0||1/S<0;if(S=isNaN(S)?f:U(Math.abs(S),M),N&&(S=Oc(S)),E&&+S==0&&p!=="+"&&(E=!1),P=(E?p==="("?p:u:p==="-"||p==="("?"":p)+P,F=(D==="s"?fi[8+so/3]:"")+F+(E&&p==="("?")":""),O){for(d=-1,m=S.length;++d<m;)if(y=S.charCodeAt(d),48>y||y>57){F=(y===46?i+S.slice(d+1):S.slice(d))+F,S=S.slice(0,d);break}}}b&&!_&&(S=n(S,1/0));var $=P.length+S.length+F.length,I=$<v?new Array(v-$+1).join(h):"";switch(b&&_&&(S=n(I+S,I.length?v-F.length:1/0),I=""),g){case"<":S=P+S+F+I;break;case"=":S=P+I+S+F;break;case"^":S=I.slice(0,$=I.length>>1)+P+S+F+I.slice($);break;default:S=I+P+S+F;break}return a(S)}return z.toString=function(){return l+""},z}function c(l,h){var g=s((l=ae(l),l.type="f",l)),p=Math.max(-8,Math.min(8,Math.floor(an(h)/3)))*3,x=Math.pow(10,-p),_=fi[8+p/3];return function(v){return g(x*v)+_}}return{format:s,formatPrefix:c}}var Fn,lo,mr;Rc({thousands:",",grouping:[3],currency:["$",""]});function Rc(t){return Fn=Fc(t),lo=Fn.format,mr=Fn.formatPrefix,Fn}function Pc(t){return Math.max(0,-an(Math.abs(t)))}function Yc(t,n){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(an(n)/3)))*3-an(Math.abs(t)))}function Lc(t,n){return t=Math.abs(t),n=Math.abs(n)-t,Math.max(0,an(n)-an(t))+1}function Hc(t,n,e,r){var i=Ye(t,n,e),a;switch(r=ae(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(n));return r.precision==null&&!isNaN(a=Yc(i,o))&&(r.precision=a),mr(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=Lc(i,Math.max(Math.abs(t),Math.abs(n))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=Pc(i))&&(r.precision=a-(r.type==="%")*2);break}}return lo(r)}function yr(t){var n=t.domain;return t.ticks=function(e){var r=n();return Yl(r[0],r[r.length-1],e??10)},t.tickFormat=function(e,r){var i=n();return Hc(i[0],i[i.length-1],e??10,r)},t.nice=function(e){e==null&&(e=10);var r=n(),i=0,a=r.length-1,o=r[i],u=r[a],f,s,c=10;for(u<o&&(s=o,o=u,u=s,s=i,i=a,a=s);c-- >0;){if(s=Pe(o,u,e),s===f)return r[i]=o,r[a]=u,n(r);if(s>0)o=Math.floor(o/s)*s,u=Math.ceil(u/s)*s;else if(s<0)o=Math.ceil(o*s)/s,u=Math.floor(u*s)/s;else break;f=s}return t},t}function vr(){var t=uo();return t.copy=function(){return pr(t,vr())},En.apply(t,arguments),yr(t)}function Wc(t,n){t=t.slice();var e=0,r=t.length-1,i=t[e],a=t[r],o;return a<i&&(o=e,e=r,r=o,o=i,i=a,a=o),t[e]=n.floor(i),t[r]=n.ceil(a),t}function hi(t){return function(n){return n<0?-Math.pow(-n,t):Math.pow(n,t)}}function qc(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Bc(t){return t<0?-t*t:t*t}function Kc(t){var n=t(ht,ht),e=1;function r(){return e===1?t(ht,ht):e===.5?t(qc,Bc):t(hi(e),hi(1/e))}return n.exponent=function(i){return arguments.length?(e=+i,r()):e},yr(n)}function co(){var t=Kc(ao());return t.copy=function(){return pr(t,co()).exponent(t.exponent())},En.apply(t,arguments),t}function Gc(){return co.apply(null,arguments).exponent(.5)}const Ne=new Date,be=new Date;function nt(t,n,e,r){function i(a){return t(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=a=>(t(a=new Date(+a)),a),i.ceil=a=>(t(a=new Date(a-1)),n(a,1),t(a),a),i.round=a=>{const o=i(a),u=i.ceil(a);return a-o<u-a?o:u},i.offset=(a,o)=>(n(a=new Date(+a),o==null?1:Math.floor(o)),a),i.range=(a,o,u)=>{const f=[];if(a=i.ceil(a),u=u==null?1:Math.floor(u),!(a<o)||!(u>0))return f;let s;do f.push(s=new Date(+a)),n(a,u),t(a);while(s<a&&a<o);return f},i.filter=a=>nt(o=>{if(o>=o)for(;t(o),!a(o);)o.setTime(o-1)},(o,u)=>{if(o>=o)if(u<0)for(;++u<=0;)for(;n(o,-1),!a(o););else for(;--u>=0;)for(;n(o,1),!a(o););}),e&&(i.count=(a,o)=>(Ne.setTime(+a),be.setTime(+o),t(Ne),t(be),Math.floor(e(Ne,be))),i.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(r?o=>r(o)%a===0:o=>i.count(0,o)%a===0):i)),i}const ue=nt(()=>{},(t,n)=>{t.setTime(+t+n)},(t,n)=>n-t);ue.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?nt(n=>{n.setTime(Math.floor(n/t)*t)},(n,e)=>{n.setTime(+n+e*t)},(n,e)=>(e-n)/t):ue);ue.range;const kt=1e3,gt=kt*60,At=gt*60,It=At*24,wr=It*7,gi=It*30,Te=It*365,jt=nt(t=>{t.setTime(t-t.getMilliseconds())},(t,n)=>{t.setTime(+t+n*kt)},(t,n)=>(n-t)/kt,t=>t.getUTCSeconds());jt.range;const Vc=nt(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*kt)},(t,n)=>{t.setTime(+t+n*gt)},(t,n)=>(n-t)/gt,t=>t.getMinutes());Vc.range;const _r=nt(t=>{t.setUTCSeconds(0,0)},(t,n)=>{t.setTime(+t+n*gt)},(t,n)=>(n-t)/gt,t=>t.getUTCMinutes());_r.range;const Xc=nt(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*kt-t.getMinutes()*gt)},(t,n)=>{t.setTime(+t+n*At)},(t,n)=>(n-t)/At,t=>t.getHours());Xc.range;const Tn=nt(t=>{t.setUTCMinutes(0,0,0)},(t,n)=>{t.setTime(+t+n*At)},(t,n)=>(n-t)/At,t=>t.getUTCHours());Tn.range;const xr=nt(t=>t.setHours(0,0,0,0),(t,n)=>t.setDate(t.getDate()+n),(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*gt)/It,t=>t.getDate()-1);xr.range;const Ct=nt(t=>{t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n)},(t,n)=>(n-t)/It,t=>t.getUTCDate()-1);Ct.range;const fo=nt(t=>{t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n)},(t,n)=>(n-t)/It,t=>Math.floor(t/It));fo.range;function Gt(t){return nt(n=>{n.setDate(n.getDate()-(n.getDay()+7-t)%7),n.setHours(0,0,0,0)},(n,e)=>{n.setDate(n.getDate()+e*7)},(n,e)=>(e-n-(e.getTimezoneOffset()-n.getTimezoneOffset())*gt)/wr)}const ho=Gt(0),se=Gt(1),Zc=Gt(2),Qc=Gt(3),un=Gt(4),Jc=Gt(5),jc=Gt(6);ho.range;se.range;Zc.range;Qc.range;un.range;Jc.range;jc.range;function Vt(t){return nt(n=>{n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-t)%7),n.setUTCHours(0,0,0,0)},(n,e)=>{n.setUTCDate(n.getUTCDate()+e*7)},(n,e)=>(e-n)/wr)}const me=Vt(0),Ht=Vt(1),tf=Vt(2),nf=Vt(3),sn=Vt(4),ef=Vt(5),rf=Vt(6);me.range;Ht.range;tf.range;nf.range;sn.range;ef.range;rf.range;const of=nt(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,n)=>{t.setMonth(t.getMonth()+n)},(t,n)=>n.getMonth()-t.getMonth()+(n.getFullYear()-t.getFullYear())*12,t=>t.getMonth());of.range;const ye=nt(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCMonth(t.getUTCMonth()+n)},(t,n)=>n.getUTCMonth()-t.getUTCMonth()+(n.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth()),af=ye.range,Kt=nt(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n)},(t,n)=>n.getFullYear()-t.getFullYear(),t=>t.getFullYear());Kt.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:nt(n=>{n.setFullYear(Math.floor(n.getFullYear()/t)*t),n.setMonth(0,1),n.setHours(0,0,0,0)},(n,e)=>{n.setFullYear(n.getFullYear()+e*t)});Kt.range;const pt=nt(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n)},(t,n)=>n.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());pt.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:nt(n=>{n.setUTCFullYear(Math.floor(n.getUTCFullYear()/t)*t),n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},(n,e)=>{n.setUTCFullYear(n.getUTCFullYear()+e*t)});pt.range;function uf(t,n,e,r,i,a){const o=[[jt,1,kt],[jt,5,5*kt],[jt,15,15*kt],[jt,30,30*kt],[a,1,gt],[a,5,5*gt],[a,15,15*gt],[a,30,30*gt],[i,1,At],[i,3,3*At],[i,6,6*At],[i,12,12*At],[r,1,It],[r,2,2*It],[e,1,wr],[n,1,gi],[n,3,3*gi],[t,1,Te]];function u(s,c,l){const h=c<s;h&&([s,c]=[c,s]);const g=l&&typeof l.range=="function"?l:f(s,c,l),p=g?g.range(s,+c+1):[];return h?p.reverse():p}function f(s,c,l){const h=Math.abs(c-s)/l,g=sr(([,,_])=>_).right(o,h);if(g===o.length)return t.every(Ye(s/Te,c/Te,l));if(g===0)return ue.every(Math.max(Ye(s,c,l),1));const[p,x]=o[h/o[g-1][2]<o[g][2]/h?g-1:g];return p.every(x)}return[u,f]}const[sf,lf]=uf(pt,ye,me,fo,Tn,_r);function Se(t){if(0<=t.y&&t.y<100){var n=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return n.setFullYear(t.y),n}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function De(t){if(0<=t.y&&t.y<100){var n=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return n.setUTCFullYear(t.y),n}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function fn(t,n,e){return{y:t,m:n,d:e,H:0,M:0,S:0,L:0}}function cf(t){var n=t.dateTime,e=t.date,r=t.time,i=t.periods,a=t.days,o=t.shortDays,u=t.months,f=t.shortMonths,s=hn(i),c=gn(i),l=hn(a),h=gn(a),g=hn(o),p=gn(o),x=hn(u),_=gn(u),v=hn(f),b=gn(f),M={a:E,A:$,b:I,B:R,c:null,d:wi,e:wi,f:Uf,g:Wf,G:Bf,H:Af,I:$f,j:If,L:go,m:Cf,M:Of,p:Y,q:B,Q:Mi,s:Ni,S:zf,u:Ff,U:Rf,V:Pf,w:Yf,W:Lf,x:null,X:null,y:Hf,Y:qf,Z:Kf,"%":xi},N={a:X,A:V,b:j,B:mt,c:null,d:_i,e:_i,f:Zf,g:ah,G:sh,H:Gf,I:Vf,j:Xf,L:mo,m:Qf,M:Jf,p:at,q:yt,Q:Mi,s:Ni,S:jf,u:th,U:nh,V:eh,w:rh,W:ih,x:null,X:null,y:oh,Y:uh,Z:lh,"%":xi},D={a:z,A:S,b:P,B:F,c:d,d:yi,e:yi,f:Sf,g:mi,G:di,H:vi,I:vi,j:Mf,L:Tf,m:xf,M:Nf,p:O,q:_f,Q:Ef,s:kf,S:bf,u:df,U:mf,V:yf,w:pf,W:vf,x:m,X:y,y:mi,Y:di,Z:wf,"%":Df};M.x=w(e,M),M.X=w(r,M),M.c=w(n,M),N.x=w(e,N),N.X=w(r,N),N.c=w(n,N);function w(A,L){return function(W){var T=[],rt=-1,K=0,ut=A.length,st,Ot,Nr;for(W instanceof Date||(W=new Date(+W));++rt<ut;)A.charCodeAt(rt)===37&&(T.push(A.slice(K,rt)),(Ot=pi[st=A.charAt(++rt)])!=null?st=A.charAt(++rt):Ot=st==="e"?" ":"0",(Nr=L[st])&&(st=Nr(W,Ot)),T.push(st),K=rt+1);return T.push(A.slice(K,rt)),T.join("")}}function k(A,L){return function(W){var T=fn(1900,void 0,1),rt=U(T,A,W+="",0),K,ut;if(rt!=W.length)return null;if("Q"in T)return new Date(T.Q);if("s"in T)return new Date(T.s*1e3+("L"in T?T.L:0));if(L&&!("Z"in T)&&(T.Z=0),"p"in T&&(T.H=T.H%12+T.p*12),T.m===void 0&&(T.m="q"in T?T.q:0),"V"in T){if(T.V<1||T.V>53)return null;"w"in T||(T.w=1),"Z"in T?(K=De(fn(T.y,0,1)),ut=K.getUTCDay(),K=ut>4||ut===0?Ht.ceil(K):Ht(K),K=Ct.offset(K,(T.V-1)*7),T.y=K.getUTCFullYear(),T.m=K.getUTCMonth(),T.d=K.getUTCDate()+(T.w+6)%7):(K=Se(fn(T.y,0,1)),ut=K.getDay(),K=ut>4||ut===0?se.ceil(K):se(K),K=xr.offset(K,(T.V-1)*7),T.y=K.getFullYear(),T.m=K.getMonth(),T.d=K.getDate()+(T.w+6)%7)}else("W"in T||"U"in T)&&("w"in T||(T.w="u"in T?T.u%7:"W"in T?1:0),ut="Z"in T?De(fn(T.y,0,1)).getUTCDay():Se(fn(T.y,0,1)).getDay(),T.m=0,T.d="W"in T?(T.w+6)%7+T.W*7-(ut+5)%7:T.w+T.U*7-(ut+6)%7);return"Z"in T?(T.H+=T.Z/100|0,T.M+=T.Z%100,De(T)):Se(T)}}function U(A,L,W,T){for(var rt=0,K=L.length,ut=W.length,st,Ot;rt<K;){if(T>=ut)return-1;if(st=L.charCodeAt(rt++),st===37){if(st=L.charAt(rt++),Ot=D[st in pi?L.charAt(rt++):st],!Ot||(T=Ot(A,W,T))<0)return-1}else if(st!=W.charCodeAt(T++))return-1}return T}function O(A,L,W){var T=s.exec(L.slice(W));return T?(A.p=c.get(T[0].toLowerCase()),W+T[0].length):-1}function z(A,L,W){var T=g.exec(L.slice(W));return T?(A.w=p.get(T[0].toLowerCase()),W+T[0].length):-1}function S(A,L,W){var T=l.exec(L.slice(W));return T?(A.w=h.get(T[0].toLowerCase()),W+T[0].length):-1}function P(A,L,W){var T=v.exec(L.slice(W));return T?(A.m=b.get(T[0].toLowerCase()),W+T[0].length):-1}function F(A,L,W){var T=x.exec(L.slice(W));return T?(A.m=_.get(T[0].toLowerCase()),W+T[0].length):-1}function d(A,L,W){return U(A,n,L,W)}function m(A,L,W){return U(A,e,L,W)}function y(A,L,W){return U(A,r,L,W)}function E(A){return o[A.getDay()]}function $(A){return a[A.getDay()]}function I(A){return f[A.getMonth()]}function R(A){return u[A.getMonth()]}function Y(A){return i[+(A.getHours()>=12)]}function B(A){return 1+~~(A.getMonth()/3)}function X(A){return o[A.getUTCDay()]}function V(A){return a[A.getUTCDay()]}function j(A){return f[A.getUTCMonth()]}function mt(A){return u[A.getUTCMonth()]}function at(A){return i[+(A.getUTCHours()>=12)]}function yt(A){return 1+~~(A.getUTCMonth()/3)}return{format:function(A){var L=w(A+="",M);return L.toString=function(){return A},L},parse:function(A){var L=k(A+="",!1);return L.toString=function(){return A},L},utcFormat:function(A){var L=w(A+="",N);return L.toString=function(){return A},L},utcParse:function(A){var L=k(A+="",!0);return L.toString=function(){return A},L}}}var pi={"-":"",_:" ",0:"0"},et=/^\s*\d+/,ff=/^%/,hf=/[\\^$*+?|[\]().{}]/g;function q(t,n,e){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<e?new Array(e-a+1).join(n)+i:i)}function gf(t){return t.replace(hf,"\\$&")}function hn(t){return new RegExp("^(?:"+t.map(gf).join("|")+")","i")}function gn(t){return new Map(t.map((n,e)=>[n.toLowerCase(),e]))}function pf(t,n,e){var r=et.exec(n.slice(e,e+1));return r?(t.w=+r[0],e+r[0].length):-1}function df(t,n,e){var r=et.exec(n.slice(e,e+1));return r?(t.u=+r[0],e+r[0].length):-1}function mf(t,n,e){var r=et.exec(n.slice(e,e+2));return r?(t.U=+r[0],e+r[0].length):-1}function yf(t,n,e){var r=et.exec(n.slice(e,e+2));return r?(t.V=+r[0],e+r[0].length):-1}function vf(t,n,e){var r=et.exec(n.slice(e,e+2));return r?(t.W=+r[0],e+r[0].length):-1}function di(t,n,e){var r=et.exec(n.slice(e,e+4));return r?(t.y=+r[0],e+r[0].length):-1}function mi(t,n,e){var r=et.exec(n.slice(e,e+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),e+r[0].length):-1}function wf(t,n,e){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(n.slice(e,e+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),e+r[0].length):-1}function _f(t,n,e){var r=et.exec(n.slice(e,e+1));return r?(t.q=r[0]*3-3,e+r[0].length):-1}function xf(t,n,e){var r=et.exec(n.slice(e,e+2));return r?(t.m=r[0]-1,e+r[0].length):-1}function yi(t,n,e){var r=et.exec(n.slice(e,e+2));return r?(t.d=+r[0],e+r[0].length):-1}function Mf(t,n,e){var r=et.exec(n.slice(e,e+3));return r?(t.m=0,t.d=+r[0],e+r[0].length):-1}function vi(t,n,e){var r=et.exec(n.slice(e,e+2));return r?(t.H=+r[0],e+r[0].length):-1}function Nf(t,n,e){var r=et.exec(n.slice(e,e+2));return r?(t.M=+r[0],e+r[0].length):-1}function bf(t,n,e){var r=et.exec(n.slice(e,e+2));return r?(t.S=+r[0],e+r[0].length):-1}function Tf(t,n,e){var r=et.exec(n.slice(e,e+3));return r?(t.L=+r[0],e+r[0].length):-1}function Sf(t,n,e){var r=et.exec(n.slice(e,e+6));return r?(t.L=Math.floor(r[0]/1e3),e+r[0].length):-1}function Df(t,n,e){var r=ff.exec(n.slice(e,e+1));return r?e+r[0].length:-1}function Ef(t,n,e){var r=et.exec(n.slice(e));return r?(t.Q=+r[0],e+r[0].length):-1}function kf(t,n,e){var r=et.exec(n.slice(e));return r?(t.s=+r[0],e+r[0].length):-1}function wi(t,n){return q(t.getDate(),n,2)}function Af(t,n){return q(t.getHours(),n,2)}function $f(t,n){return q(t.getHours()%12||12,n,2)}function If(t,n){return q(1+xr.count(Kt(t),t),n,3)}function go(t,n){return q(t.getMilliseconds(),n,3)}function Uf(t,n){return go(t,n)+"000"}function Cf(t,n){return q(t.getMonth()+1,n,2)}function Of(t,n){return q(t.getMinutes(),n,2)}function zf(t,n){return q(t.getSeconds(),n,2)}function Ff(t){var n=t.getDay();return n===0?7:n}function Rf(t,n){return q(ho.count(Kt(t)-1,t),n,2)}function po(t){var n=t.getDay();return n>=4||n===0?un(t):un.ceil(t)}function Pf(t,n){return t=po(t),q(un.count(Kt(t),t)+(Kt(t).getDay()===4),n,2)}function Yf(t){return t.getDay()}function Lf(t,n){return q(se.count(Kt(t)-1,t),n,2)}function Hf(t,n){return q(t.getFullYear()%100,n,2)}function Wf(t,n){return t=po(t),q(t.getFullYear()%100,n,2)}function qf(t,n){return q(t.getFullYear()%1e4,n,4)}function Bf(t,n){var e=t.getDay();return t=e>=4||e===0?un(t):un.ceil(t),q(t.getFullYear()%1e4,n,4)}function Kf(t){var n=t.getTimezoneOffset();return(n>0?"-":(n*=-1,"+"))+q(n/60|0,"0",2)+q(n%60,"0",2)}function _i(t,n){return q(t.getUTCDate(),n,2)}function Gf(t,n){return q(t.getUTCHours(),n,2)}function Vf(t,n){return q(t.getUTCHours()%12||12,n,2)}function Xf(t,n){return q(1+Ct.count(pt(t),t),n,3)}function mo(t,n){return q(t.getUTCMilliseconds(),n,3)}function Zf(t,n){return mo(t,n)+"000"}function Qf(t,n){return q(t.getUTCMonth()+1,n,2)}function Jf(t,n){return q(t.getUTCMinutes(),n,2)}function jf(t,n){return q(t.getUTCSeconds(),n,2)}function th(t){var n=t.getUTCDay();return n===0?7:n}function nh(t,n){return q(me.count(pt(t)-1,t),n,2)}function yo(t){var n=t.getUTCDay();return n>=4||n===0?sn(t):sn.ceil(t)}function eh(t,n){return t=yo(t),q(sn.count(pt(t),t)+(pt(t).getUTCDay()===4),n,2)}function rh(t){return t.getUTCDay()}function ih(t,n){return q(Ht.count(pt(t)-1,t),n,2)}function oh(t,n){return q(t.getUTCFullYear()%100,n,2)}function ah(t,n){return t=yo(t),q(t.getUTCFullYear()%100,n,2)}function uh(t,n){return q(t.getUTCFullYear()%1e4,n,4)}function sh(t,n){var e=t.getUTCDay();return t=e>=4||e===0?sn(t):sn.ceil(t),q(t.getUTCFullYear()%1e4,n,4)}function lh(){return"+0000"}function xi(){return"%"}function Mi(t){return+t}function Ni(t){return Math.floor(+t/1e3)}var Xt,Wt;ch({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function ch(t){return Xt=cf(t),Xt.format,Xt.parse,Wt=Xt.utcFormat,Xt.utcParse,Xt}function fh(t){return new Date(t)}function hh(t){return t instanceof Date?+t:+new Date(+t)}function vo(t,n,e,r,i,a,o,u,f,s){var c=uo(),l=c.invert,h=c.domain,g=s(".%L"),p=s(":%S"),x=s("%I:%M"),_=s("%I %p"),v=s("%a %d"),b=s("%b %d"),M=s("%B"),N=s("%Y");function D(w){return(f(w)<w?g:u(w)<w?p:o(w)<w?x:a(w)<w?_:r(w)<w?i(w)<w?v:b:e(w)<w?M:N)(w)}return c.invert=function(w){return new Date(l(w))},c.domain=function(w){return arguments.length?h(Array.from(w,hh)):h().map(fh)},c.ticks=function(w){var k=h();return t(k[0],k[k.length-1],w??10)},c.tickFormat=function(w,k){return k==null?D:s(k)},c.nice=function(w){var k=h();return(!w||typeof w.range!="function")&&(w=n(k[0],k[k.length-1],w??10)),w?h(Wc(k,w)):c},c.copy=function(){return pr(c,vo(t,n,e,r,i,a,o,u,f,s))},c}function gh(){return En.apply(vo(sf,lf,pt,ye,me,Ct,Tn,_r,jt,Wt).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function ph(){var t=0,n=1,e,r,i,a,o=ht,u=!1,f;function s(l){return l==null||isNaN(l=+l)?f:o(i===0?.5:(l=(a(l)-e)*i,u?Math.max(0,Math.min(1,l)):l))}s.domain=function(l){return arguments.length?([t,n]=l,e=a(t=+t),r=a(n=+n),i=e===r?0:1/(r-e),s):[t,n]},s.clamp=function(l){return arguments.length?(u=!!l,s):u},s.interpolator=function(l){return arguments.length?(o=l,s):o};function c(l){return function(h){var g,p;return arguments.length?([g,p]=h,o=l(g,p),s):[o(0),o(1)]}}return s.range=c(fe),s.rangeRound=c(Li),s.unknown=function(l){return arguments.length?(f=l,s):f},function(l){return a=l,e=l(t),r=l(n),i=e===r?0:1/(r-e),s}}function dh(t,n){return n.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function wo(){var t=yr(ph()(ht));return t.copy=function(){return dh(t,wo())},Tc.apply(t,arguments)}class mh extends pe{constructor(e,r){super(e);C(this,"svg");C(this,"tile");C(this,"zoom");C(this,"projection");C(this,"hexbin");C(this,"radius");C(this,"binsContainer");C(this,"tileProviders",new Map([[0,{url:(e,r,i)=>`https://tile.openstreetmap.org/${i}/${e}/${r}.png`,tileSize:256}]]));C(this,"images");C(this,"currTransform");C(this,"currData");C(this,"options");C(this,"tileProviderData");this.options={initialTileProvider:r&&r.initialTileProvider||0,initialScale:r&&r.initialScale||16384,initialCenter:r&&r.initialCenter||[-2.983333,53.400002],boundingBox:r&&r.boundingBox||[[0,0],[0,0]]},this.svg=ce("svg").attr("width","100%").attr("height","100%"),this.projection=wc().scale(1/(2*Math.PI)).translate([0,0]),this.hexbin=bc().extent([[0,0],[this.width,this.height]]).radius(10),this.radius=Gc().range([0,this.hexbin.radius()]),this.tileProviderData=this.tileProviders.get(this.options.initialTileProvider),this.tile=Mu().tileSize(this.tileProviderData.tileSize).clampX(!1),this.zoom=Sl().scaleExtent([256,1<<24]).extent([[0,0],[this.width,this.height]]).on("zoom",this.onZoom.bind(this)),this.images=this.svg.append("g").attr("pointer-events","none").selectAll("image"),this.binsContainer=this.svg.append("g"),setTimeout(()=>{this.currTransform=ur.translate(this.width/2,this.height/2).scale(-this.options.initialScale).translate(...this.projection(this.options.initialCenter)).scale(-1),this.svg.call(this.zoom).call(this.zoom.transform,this.currTransform)},0),this.container.append(this.svg.node())}update(e){this.currData=e;let r=this.hexbin(e.reduce((i,a)=>{const o=this.projection([a.longitude,a.latitude]);return!o||o[0]<0||o[0]>this.width||o[1]<0||o[1]>this.height||i.push(o),i},new Array));this.radius.domain([0,Ll(r,i=>i.length)]),r=r.filter(i=>this.radius(i.length)>1),this.binsContainer.selectAll("path").data(r).join("path").attr("transform",i=>`translate(${i.x},${i.y})`).attr("d",i=>this.hexbin.hexagon(this.radius(i.length))).attr("fill","red").attr("opacity",.35)}resize(){this.tile.extent([[0,0],[this.width,this.height]]),this.zoom.extent([[0,0],[this.width,this.height]]),this.hexbin.extent([[0,0],[this.width,this.height]]),this.refreshTransform()}onZoom(e){this.currTransform=e.transform;const r=this.tile(this.currTransform);return this.images=this.images.data(r,i=>i).join("image").attr("xlink:href",i=>this.tileProviderData.url(...Nu(i))).attr("x",([i])=>(i+r.translate[0])*r.scale).attr("y",([,i])=>(i+r.translate[1])*r.scale).attr("width",r.scale).attr("height",r.scale),this.projection.scale(this.currTransform.k/(2*Math.PI)).translate([this.currTransform.x,this.currTransform.y]),this.currData!=null&&this.update(this.currData),this.svg.node()}refreshTransform(){try{this.svg.call(this.zoom.transform,this.currTransform)}catch(e){if(!(e instanceof TypeError))throw e}}}function yh(t){return t}var Bn=1,Ee=2,Ve=3,vn=4,bi=1e-6;function vh(t){return"translate("+t+",0)"}function wh(t){return"translate(0,"+t+")"}function _h(t){return n=>+t(n)}function xh(t,n){return n=Math.max(0,t.bandwidth()-n*2)/2,t.round()&&(n=Math.round(n)),e=>+t(e)+n}function Mh(){return!this.__axis}function Mr(t,n){var e=[],r=null,i=null,a=6,o=6,u=3,f=typeof window<"u"&&window.devicePixelRatio>1?0:.5,s=t===Bn||t===vn?-1:1,c=t===vn||t===Ee?"x":"y",l=t===Bn||t===Ve?vh:wh;function h(g){var p=r??(n.ticks?n.ticks.apply(n,e):n.domain()),x=i??(n.tickFormat?n.tickFormat.apply(n,e):yh),_=Math.max(a,0)+u,v=n.range(),b=+v[0]+f,M=+v[v.length-1]+f,N=(n.bandwidth?xh:_h)(n.copy(),f),D=g.selection?g.selection():g,w=D.selectAll(".domain").data([null]),k=D.selectAll(".tick").data(p,n).order(),U=k.exit(),O=k.enter().append("g").attr("class","tick"),z=k.select("line"),S=k.select("text");w=w.merge(w.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),k=k.merge(O),z=z.merge(O.append("line").attr("stroke","currentColor").attr(c+"2",s*a)),S=S.merge(O.append("text").attr("fill","currentColor").attr(c,s*_).attr("dy",t===Bn?"0em":t===Ve?"0.71em":"0.32em")),g!==D&&(w=w.transition(g),k=k.transition(g),z=z.transition(g),S=S.transition(g),U=U.transition(g).attr("opacity",bi).attr("transform",function(P){return isFinite(P=N(P))?l(P+f):this.getAttribute("transform")}),O.attr("opacity",bi).attr("transform",function(P){var F=this.parentNode.__axis;return l((F&&isFinite(F=F(P))?F:N(P))+f)})),U.remove(),w.attr("d",t===vn||t===Ee?o?"M"+s*o+","+b+"H"+f+"V"+M+"H"+s*o:"M"+f+","+b+"V"+M:o?"M"+b+","+s*o+"V"+f+"H"+M+"V"+s*o:"M"+b+","+f+"H"+M),k.attr("opacity",1).attr("transform",function(P){return l(N(P)+f)}),z.attr(c+"2",s*a),S.attr(c,s*_).text(x),D.filter(Mh).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===Ee?"start":t===vn?"end":"middle"),D.each(function(){this.__axis=N})}return h.scale=function(g){return arguments.length?(n=g,h):n},h.ticks=function(){return e=Array.from(arguments),h},h.tickArguments=function(g){return arguments.length?(e=g==null?[]:Array.from(g),h):e.slice()},h.tickValues=function(g){return arguments.length?(r=g==null?null:Array.from(g),h):r&&r.slice()},h.tickFormat=function(g){return arguments.length?(i=g,h):i},h.tickSize=function(g){return arguments.length?(a=o=+g,h):a},h.tickSizeInner=function(g){return arguments.length?(a=+g,h):a},h.tickSizeOuter=function(g){return arguments.length?(o=+g,h):o},h.tickPadding=function(g){return arguments.length?(u=+g,h):u},h.offset=function(g){return arguments.length?(f=+g,h):f},h}function Nh(t){return Mr(Bn,t)}function bh(t){return Mr(Ve,t)}function _o(t){return Mr(vn,t)}class Rn extends pe{constructor(e,r,i,a,o,u,f){super(e);C(this,"svg");C(this,"x");C(this,"y");C(this,"color");C(this,"g");C(this,"outerGroupBy");C(this,"outerGroupByKeyStringifier");C(this,"innerGroupBy");C(this,"innerGroupByKeyColor");C(this,"currentData");C(this,"margins",{top:30,right:20,bottom:10,left:150});this.innerGroupBy=o,this.outerGroupBy=r,this.outerGroupByKeyStringifier=a,this.innerGroupByKeyColor=u,this.svg=ce("svg").attr("width","100%").attr("height","100%"),this.x=vr().domain([0,f]),this.y=oo().domain(i).padding(.2),this.color=gr(),this.g=this.svg.append("g"),this.container.append(this.svg.node())}update(e){const r=new Set,i=e.reduce((o,u)=>{const f=this.outerGroupBy(u),s=this.innerGroupBy(u);o.get(f)==null&&o.set(f,new Map);const c=o.get(f);return c.get(s)==null&&c.set(s,0),c.set(s,c.get(s)+1),r.add(s),o},new Map),a=new Map;for(const[o,u]of i){const f=[...u.entries()].sort((s,c)=>c[1]-s[1]).reduce((s,[c,l],h)=>(h==0?s.push([c,{parentKey:o,start:0,end:l}]):s.push([c,{parentKey:o,start:s[h-1][1].end,end:s[h-1][1].end+l}]),s),new Array);a.set(o,new Map(f))}this.svg.select("g.x-axis").remove(),this.svg.append("g").attr("class","x-axis").attr("transform",`translate(0,${this.margins.top})`).call(Nh(this.x).ticks(this.width/80).tickFormat(mr(".1",1e3))).call(o=>o.selectAll(".tick line").clone().attr("y2",this.height-this.margins.top-this.margins.bottom).attr("stroke-opacity",.1)),this.svg.select("g.y-axis").remove(),this.svg.append("g").attr("class","y-axis").attr("transform",`translate(${this.margins.left},0)`).call(_o(this.y).tickFormat(this.outerGroupByKeyStringifier)).call(o=>o.selectAll(".domain").remove()),this.color.domain(r).range([...r.values()].map(o=>this.innerGroupByKeyColor(o))),this.g.selectAll("g").data(a).join("g").attr("x",0).attr("y",([o])=>this.y(o)).selectAll("rect").data(([,o])=>o).join("rect").attr("fill",([o])=>this.color(o)).attr("x",([,o])=>this.x(o.start)).attr("y",([,o])=>this.y(o.parentKey)).attr("width",([,o])=>this.x(o.end)-this.x(o.start)).attr("height",this.y.bandwidth()).classed("hoverable",!0).append("title").text(([o,u])=>`accidents: ${u.end-u.start}
severity: ${Ti[o]}`),this.currentData=e}resize(){this.x.range([this.margins.left,this.width-this.margins.right]),this.y.range([this.margins.top,this.height-this.margins.bottom]),this.currentData&&this.update(this.currentData)}setXAxisMax(e){this.x.domain([0,e])}}function xo(t){const n=lr(t,e=>e.date.getUTCFullYear());return n.delete(2004),n.delete(2008),n}class Th{constructor(n,e,r,i,a,o,u){C(this,"playStopBtn");C(this,"label");C(this,"input");C(this,"loopCheckbox");C(this,"datalist");C(this,"data");C(this,"datedData");C(this,"dateMapping");C(this,"isPlaying",!1);C(this,"id");C(this,"options");this.input=n,this.playStopBtn=e,this.label=i,this.loopCheckbox=r,this.datalist=a,this.data=o,this.options={interval:u&&u.interval||1e3,loop:u&&u.loop||!1,autoplay:u&&u.autoplay||!0},this.datedData=xo(this.data),this.dateMapping=[...this.datedData.keys()].sort(),this.input.min="0",this.input.max=([...this.datedData.keys()].length-1).toString(),this.input.addEventListener("change",this.onInput.bind(this));for(let f=0;f<=parseInt(this.input.max,10);++f){const s=document.createElement("option");s.value=f.toString(),s.label=this.dateMapping[f].toString(),this.datalist.appendChild(s)}setTimeout(()=>{this.input.value="0",this.onInput(),this.options.autoplay&&this.play()},0),this.playStopBtn.addEventListener("click",this.onPlayStop.bind(this)),this.loopCheckbox.addEventListener("change",this.onLoopToggle.bind(this))}update(){if(this.options.loop){this.id=setTimeout(()=>{this.input.value=`${(parseInt(this.input.value,10)+1)%(parseInt(this.input.max,10)+1)}`,this.onInput(),this.update()},this.options.interval);return}const n=parseInt(this.input.value,10)+1;if(n>parseInt(this.input.max,10)){this.stop();return}this.id=setTimeout(()=>{this.input.value=n.toString(),this.onInput(),this.update()},this.options.interval)}play(){this.isPlaying||(this.isPlaying=!0,this.playStopBtn.classList.remove("stopped"),this.playStopBtn.classList.add("playing"),this.playStopBtn.textContent="Stop",parseInt(this.input.value,10)==parseInt(this.input.max)&&(this.input.value="0",this.onInput()),this.update())}stop(){this.isPlaying&&(this.isPlaying=!1,this.playStopBtn.classList.remove("playing"),this.playStopBtn.classList.add("stopped"),this.playStopBtn.textContent="Play",clearTimeout(this.id))}onPlayStop(){this.isPlaying?this.stop():this.play()}onInput(){const n=this.dateMapping[parseInt(this.input.value,10)];document.dispatchEvent(new CustomEvent("date-update",{detail:{data:this.datedData.get(n)}})),this.label.textContent=`${n}`}onLoopToggle(){this.options.loop=this.loopCheckbox.checked}}function Sh(t){for(var n=t.length/6|0,e=new Array(n),r=0;r<n;)e[r]="#"+t.slice(r*6,++r*6);return e}const Dh=t=>Gu(t[t.length-1]);var Eh=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Sh);const kh=Dh(Eh);class Ah extends pe{constructor(e,r){super(e);C(this,"svg");C(this,"g");C(this,"processedData",new Map);C(this,"yearlyColorScales",new Map);C(this,"selectedDay");C(this,"margins",{top:20,right:10,bottom:10,left:80});this.svg=ce("svg").attr("width","100%").attr("height","100%"),this.g=this.svg.append("g").attr("transform",`translate(${this.margins.left},${this.margins.top})`),this.container.append(this.svg.node()),this.preprocess(r),setTimeout(this.update.bind(this),0)}preprocess(e){xo(e).forEach((i,a)=>{const o=new Map,u=lr(i,s=>Ct.count(pt(s.date),s.date));let f=Number.NEGATIVE_INFINITY;u.forEach((s,c)=>{f=Math.max(f,s.length);const l=Ct(s[0].date);o.set(c,{value:s.length,weekInYearIdx:Ht.count(pt(l),l),dayInWeekIdx:(l.getUTCDay()+6)%7,year:a,date:l,originalData:s})}),this.processedData.set(a,o),this.yearlyColorScales.set(a,wo(kh).domain([0,f]))})}update(){const e={width:this.width-(this.margins.left+this.margins.right),height:(this.height-(this.margins.top+this.margins.bottom))/this.processedData.size},r={width:Math.floor(e.width/(366/7+1)),height:Math.floor(e.height/7)},i=this.g.selectAll("g.year-container").data(this.processedData).join("g").attr("class","year-container").attr("transform",(u,f)=>`translate(0,${e.height*f})`);i.select("text.year-label").remove(),i.append("text").attr("class","year-label").attr("text-anchor","end").attr("font-size","10px").attr("x",-35).attr("y",10).attr("font-weight","bold").text(([u])=>u),i.select("g.day-labels-container").remove(),i.append("g").attr("transform","translate(-5,+5)").attr("class","day-labels-container").attr("text-anchor","end").attr("font-size","8px").attr("font-weight","bold").selectAll().data(Ji(0,7)).join("text").attr("y",u=>u*r.height).attr("dy","0.31em").text(u=>["MON","TUE","WED","THU","FRI","SAT","SUN"][u]),i.select("g").remove(),i.append("g").selectAll("rect").data(([,u])=>u).join("rect").attr("width",r.width-1).attr("height",r.height-1).attr("x",([,u])=>u.weekInYearIdx*r.width).attr("y",([,u])=>u.dayInWeekIdx*r.height).attr("fill",([,u])=>this.yearlyColorScales.get(u.year)(u.value)).classed("hoverable",!0).on("click",this.onDaySelect.bind(this)).append("title").text(([,u])=>`date: ${Wt("%B %d, %Y")(u.date)}
accidents: ${u.value}`),this.g.select("g.month-labels-container").remove(),i.filter((u,f)=>f==0).append("g").attr("class","month-labels-container").selectAll().data(([,u])=>af(ye(u.get(0).date),u.get(u.size-1).date)).join("g").append("text").attr("x",u=>Ht.count(pt(u),Ht.ceil(u))*r.width).attr("y",-5).text(Wt("%b"))}resize(){this.update()}onDaySelect(e,r){var i;this.selectedDay&&this.selectedDay.classed("day-selection",!1),this.selectedDay=Dt(e.currentTarget),(i=this.selectedDay)==null||i.classed("day-selection",!0),document.dispatchEvent(new CustomEvent("dayselectionevent",{detail:{data:r[1].originalData}}))}}function Zt(t){return function(){return t}}const Xe=Math.PI,Ze=2*Xe,Pt=1e-6,$h=Ze-Pt;function Mo(t){this._+=t[0];for(let n=1,e=t.length;n<e;++n)this._+=arguments[n]+t[n]}function Ih(t){let n=Math.floor(t);if(!(n>=0))throw new Error(`invalid digits: ${t}`);if(n>15)return Mo;const e=10**n;return function(r){this._+=r[0];for(let i=1,a=r.length;i<a;++i)this._+=Math.round(arguments[i]*e)/e+r[i]}}class Uh{constructor(n){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=n==null?Mo:Ih(n)}moveTo(n,e){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+e}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(n,e){this._append`L${this._x1=+n},${this._y1=+e}`}quadraticCurveTo(n,e,r,i){this._append`Q${+n},${+e},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(n,e,r,i,a,o){this._append`C${+n},${+e},${+r},${+i},${this._x1=+a},${this._y1=+o}`}arcTo(n,e,r,i,a){if(n=+n,e=+e,r=+r,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let o=this._x1,u=this._y1,f=r-n,s=i-e,c=o-n,l=u-e,h=c*c+l*l;if(this._x1===null)this._append`M${this._x1=n},${this._y1=e}`;else if(h>Pt)if(!(Math.abs(l*f-s*c)>Pt)||!a)this._append`L${this._x1=n},${this._y1=e}`;else{let g=r-o,p=i-u,x=f*f+s*s,_=g*g+p*p,v=Math.sqrt(x),b=Math.sqrt(h),M=a*Math.tan((Xe-Math.acos((x+h-_)/(2*v*b)))/2),N=M/b,D=M/v;Math.abs(N-1)>Pt&&this._append`L${n+N*c},${e+N*l}`,this._append`A${a},${a},0,0,${+(l*g>c*p)},${this._x1=n+D*f},${this._y1=e+D*s}`}}arc(n,e,r,i,a,o){if(n=+n,e=+e,r=+r,o=!!o,r<0)throw new Error(`negative radius: ${r}`);let u=r*Math.cos(i),f=r*Math.sin(i),s=n+u,c=e+f,l=1^o,h=o?i-a:a-i;this._x1===null?this._append`M${s},${c}`:(Math.abs(this._x1-s)>Pt||Math.abs(this._y1-c)>Pt)&&this._append`L${s},${c}`,r&&(h<0&&(h=h%Ze+Ze),h>$h?this._append`A${r},${r},0,1,${l},${n-u},${e-f}A${r},${r},0,1,${l},${this._x1=s},${this._y1=c}`:h>Pt&&this._append`A${r},${r},0,${+(h>=Xe)},${l},${this._x1=n+r*Math.cos(a)},${this._y1=e+r*Math.sin(a)}`)}rect(n,e,r,i){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+e}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function Ch(t){let n=3;return t.digits=function(e){if(!arguments.length)return n;if(e==null)n=null;else{const r=Math.floor(e);if(!(r>=0))throw new RangeError(`invalid digits: ${e}`);n=r}return t},()=>new Uh(n)}function Oh(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function No(t){this._context=t}No.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:this._context.lineTo(t,n);break}}};function zh(t){return new No(t)}function Fh(t){return t[0]}function Rh(t){return t[1]}function Ph(t,n){var e=Zt(!0),r=null,i=zh,a=null,o=Ch(u);t=typeof t=="function"?t:t===void 0?Fh:Zt(t),n=typeof n=="function"?n:n===void 0?Rh:Zt(n);function u(f){var s,c=(f=Oh(f)).length,l,h=!1,g;for(r==null&&(a=i(g=o())),s=0;s<=c;++s)!(s<c&&e(l=f[s],s,f))===h&&((h=!h)?a.lineStart():a.lineEnd()),h&&a.point(+t(l,s,f),+n(l,s,f));if(g)return a=null,g+""||null}return u.x=function(f){return arguments.length?(t=typeof f=="function"?f:Zt(+f),u):t},u.y=function(f){return arguments.length?(n=typeof f=="function"?f:Zt(+f),u):n},u.defined=function(f){return arguments.length?(e=typeof f=="function"?f:Zt(!!f),u):e},u.curve=function(f){return arguments.length?(i=f,r!=null&&(a=i(r)),u):i},u.context=function(f){return arguments.length?(f==null?r=a=null:a=i(r=f),u):r},u}function bo(t,n){this._context=t,this._t=n}bo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,n),this._context.lineTo(t,n);else{var e=this._x*(1-this._t)+t*this._t;this._context.lineTo(e,this._y),this._context.lineTo(e,n)}break}}this._x=t,this._y=n}};function Yh(t){return new bo(t,1)}class Lh extends pe{constructor(e){super(e);C(this,"svg");C(this,"path");C(this,"g");C(this,"x");C(this,"y");C(this,"currentData");C(this,"margins",{top:30,right:20,bottom:40,left:80});this.svg=ce("svg").attr("width","100%").attr("height","100%"),this.path=this.svg.append("path").attr("fill","none").attr("stroke","steelblue").attr("stroke-width",1.5),this.g=this.svg.append("g").attr("stroke","#000").attr("stroke-opacity",.2),this.x=gh(),this.y=vr(),this.container.append(this.svg.node())}update(e){this.currentData=e;const r=Tn.range(Ct.floor(e[0].date),Ct.ceil(e[0].date)),i=new Map,a=lr(e,s=>Tn(s.date));[...a.keys()].sort().forEach(s=>{i.set(s,a.get(s))});let o=Number.NEGATIVE_INFINITY;i.forEach(s=>{o=Math.max(o,s.length)}),this.x.domain([r[0],r[r.length-1]]),this.svg.select("g.x-axis").remove(),this.svg.append("g").attr("class","x-axis").attr("transform",`translate(0,${this.height-this.margins.bottom})`).call(bh(this.x).tickFormat(Wt("%H"))).call(s=>s.append("text").attr("text-anchor","end").attr("x",this.width-this.margins.right).attr("y",this.margins.bottom-15).text(" Day Hour")),this.y.domain([0,o]),this.svg.select("g.y-axis").remove(),this.svg.append("g").attr("class","y-axis").attr("transform",`translate(${this.margins.left},0)`).call(_o(this.y)).call(s=>s.append("text").attr("text-anchor","start").attr("x",-this.margins.left+10).attr("y",15).text(" Number Accidents"));const u=new Array;i.forEach((s,c)=>{u.push([this.x(c),this.y(s.length)])}),u.sort((s,c)=>s[0]-c[0]);const f=Ph().x(s=>s[0]).y(s=>s[1]).curve(Yh);this.path.attr("d",f(u)),this.g.selectAll("circle").data(i).join("circle").attr("cx",([s])=>this.x(s)).attr("cy",([,s])=>this.y(s.length)).attr("fill","white").attr("r",2.5).append("title").text(([s,c])=>`hour: ${Wt("%H:%M")(s)}
day: ${Wt("%B %d, %Y")(s)}
accidents: ${c.length}`)}resize(){this.x.range([this.margins.left,this.width-this.margins.right]),this.y.range([this.height-this.margins.bottom,this.margins.top]),this.currentData&&this.update(this.currentData)}}const To=document.querySelector("#map-container");if(To==null)throw new Error("couldn't find the map container");const Qe=document.querySelector("#csv-dataset-importer");if(Qe==null)throw new Error("couldn't find the CSV dataset importer");const So=document.querySelector("#import-btn");if(So==null)throw new Error("couldn't find the import button");const Do=document.querySelector("#timestamp-player-range-input");if(Do==null)throw new Error("couldn't find the timestamp (year) range input. Aborting ...");const Eo=document.querySelector("#date-player-label");if(Eo==null)throw new Error("couldn't find the date player label. Aborting ...");const ko=document.querySelector("#play-stop-btn");if(ko==null)throw new Error("couldn't find the date player's play/stop button. Aborting ...");const Ao=document.querySelector("#date-player-loop");if(Ao==null)throw new Error("couldn't find the date player's loop toggle. Aborting ...");const $o=document.querySelector("#date-player-list");if($o==null)throw new Error("couldn't find the date player's datalist. Aborting ...");const Io=document.querySelector("#horizontal-bar-chart-container-00");if(Io==null)throw new Error("couldn't find horizontal bar container 00. Aborting ...");const Uo=document.querySelector("#horizontal-bar-chart-container-01");if(Uo==null)throw new Error("couldn't find horizontal bar container 01. Aborting ...");const Co=document.querySelector("#horizontal-bar-chart-container-02");if(Co==null)throw new Error("couldn't find horizontal bar container 02. Aborting ...");const Oo=document.querySelector("#horizontal-bar-chart-container-03");if(Oo==null)throw new Error("couldn't find horizontal bar container 03. Aborting ...");const zo=document.querySelector("#calendar-container");if(!zo)throw new Error("couldn't find the calendar visualization container. Aborting ...");const Fo=document.querySelector("#line-chart-container");if(!Fo)throw new Error("couldn't find the line chart visualization container. Aborting ...");const Hh=[new mh(To),new Rn(Io,t=>t.speedLimit,Object.values(ke).filter(t=>!Number.isNaN(Number(t))),t=>ke[t].replace("_"," ").toLowerCase(),t=>t.accidentSeverity,t=>["#ffdd59","#ffa801","#ff3f34"][t-1],15e4),new Rn(Uo,t=>t.roadType,Object.values(Tt).filter(t=>!Number.isNaN(Number(t))),t=>Tt[t].replace("_"," ").toLowerCase(),t=>t.accidentSeverity,t=>["#ffdd59","#ffa801","#ff3f34"][t-1],15e4),new Rn(Co,t=>t.roadSurfaceConditions,Object.values(St).filter(t=>!Number.isNaN(Number(t))),t=>St[t].replace("_"," ").toLowerCase(),t=>t.accidentSeverity,t=>["#ffdd59","#ffa801","#ff3f34"][t-1],15e4),new Rn(Oo,t=>t.weatherConditions,Object.values(ft).filter(t=>!Number.isNaN(Number(t))),t=>ft[t].replace("_"," ").toLowerCase(),t=>t.accidentSeverity,t=>["#ffdd59","#ffa801","#ff3f34"][t-1],15e4)],Wh=new Lh(Fo);So.addEventListener("click",async()=>{var n;if(!((n=Qe.files)!=null&&n.length))return;const t=await Yo(Qe.files[0]);new Th(Do,ko,Ao,Eo,$o,t),new Ah(zo,t)});document.addEventListener("date-update",t=>{Hh.forEach(n=>n.update(t.detail.data))});document.addEventListener("dayselectionevent",t=>{Wh.update(t.detail.data)});
</script>
  <style rel="stylesheet" crossorigin>html,body{font-family:sans-serif;color:#dcdde1;background-color:#3c3c3c;font-size:.8rem;margin:0;height:100%;display:flex;flex-direction:column;gap:5px;overflow-y:hidden}#dataset-importer-container{display:flex;flex-direction:row;justify-content:space-between;gap:10px;align-items:baseline;padding:5px 10px;border-style:hidden;background-color:#262626}#visualizations-container{display:flex;flex-direction:row;justify-content:space-around;flex:1;gap:5px}#left-side-container,#right-side-container{display:flex;flex-direction:column;gap:5px;justify-content:space-between;width:50%}#map-container{flex-grow:9}#timestamp-player-container{display:flex;flex-direction:row;justify-content:space-between;gap:10px;background-color:#262626;align-items:center;padding:5px 10px}#import-btn,#csv-dataset-importer,#timestamp-player-range-input{flex-grow:1}.left-side-charts-container{display:flex;flex-direction:row;gap:5px;flex-grow:1}.left-side-charts-container>div{width:50%;background-color:#262626}#calendar-container{flex-grow:6;width:100%;background-color:#262626}#line-chart-container{flex-grow:1;width:100%;background-color:#262626}text{fill:#dcdde1}.day-selection{stroke:#7fff00;stroke-width:3px}.hoverable:hover{stroke:#f5f6fa;stroke-width:2px}button{background-color:#fff;border:1px solid #d5d9d9;color:#0f1111;cursor:pointer;display:inline-block;font-family:sans-serif;line-height:20px;padding:0 10px 0 11px;position:relative;text-align:center;text-decoration:none;user-select:none;-webkit-user-select:none;touch-action:manipulation;vertical-align:middle;width:100px}button:hover{background-color:#0c76cc;border-color:#0c76cc;color:#d5d9d9}button:focus{border-color:#0c76cc}
</style>
</head>

<body>
    <div id="dataset-importer-container">
        <!-- dataset importer(s) go(es) here -->
        <label for="csv-dataset-importer">
            Select .csv(.zip) UK Accidents Dataset:
        </label>
        <input id="csv-dataset-importer" type="file" accept=".csv" />
        <button id="import-btn">
            Import
        </button>
    </div>
    <div id="visualizations-container">
        <div id="left-side-container">
            <div id="map-container"></div>
            <div class="left-side-charts-container">
                <div id="horizontal-bar-chart-container-00"></div>
                <div id="horizontal-bar-chart-container-01"></div>
            </div>
            <div class="left-side-charts-container">
                <div id="horizontal-bar-chart-container-02"></div>
                <div id="horizontal-bar-chart-container-03"></div>
            </div>
            <div id="timestamp-player-container">
                <button id="play-stop-btn">Play</button>
                <label id="date-player-label" for="timestamp-player-range-input">init</label>
                <input id="timestamp-player-range-input" type="range" step="1" min="0" max="0" list="date-player-list">
                <datalist id="date-player-list"></datalist>
                <label for="loop">Loop: </label>
                <input type="checkbox" id="date-player-loop" name="loop" />
            </div>
        </div>
        <div id="right-side-container">
            <div id="calendar-container"></div>
            <div id="line-chart-container"></div>
        </div>
    </div>
</body>

</html>